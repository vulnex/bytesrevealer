/**
 * Kaitai Formats - Executable
 * 11 formats
 * Auto-generated: 2025-09-21T19:51:05.639Z
 */

export const executableFormats = [
  {
    "id": "ksy_android_nanoapp_header",
    "name": "Android nanoapp header",
    "category": "Executable",
    "metadata": {
      "isGenerated": true,
      "fileExtensions": [
        "napp_header"
      ],
      "description": "Android nanoapp header",
      "originalCategory": "executable",
      "filePath": "executable/android_nanoapp_header.ksy",
      "signature": {
        "offset": 0,
        "bytes": [
          78,
          65,
          78,
          79
        ]
      },
      "endian": "le"
    },
    "content": "meta:\n  id: android_nanoapp_header\n  title: Android nanoapp header\n  file-extension: napp_header\n  tags:\n    - android\n    - executable\n  license: Apache-2.0\n  ks-version: 0.9\n  endian: le\ndoc-ref: https://android.googlesource.com/platform/system/chre/+/a7ff61b9/build/build_template.mk#130\nseq:\n  - id: header_version\n    type: u4\n    valid: 1\n  - id: magic\n    contents: \"NANO\"\n  - id: app_id\n    type: u8\n  - id: app_version\n    type: u4\n  - id: flags\n    type: u4\n  - id: hub_type\n    type: u8\n  - id: chre_api_major_version\n    type: u1\n  - id: chre_api_minor_version\n    type: u1\n  - id: reserved\n    contents: [0, 0, 0, 0, 0, 0]\ninstances:\n  is_signed:\n    value: flags & 0x1 != 0\n  is_encrypted:\n    value: flags & 0x2 != 0\n  is_tcm_capable:\n    value: flags & 0x4 != 0\n"
  },
  {
    "id": "ksy_dex",
    "name": "Android Dalvik VM executable (dex)",
    "category": "Executable",
    "metadata": {
      "isGenerated": true,
      "fileExtensions": [
        "dex"
      ],
      "description": "Android Dalvik VM executable (dex)",
      "originalCategory": "executable",
      "filePath": "executable/dex.ksy",
      "endian": "le"
    },
    "content": "meta:\n  id: dex\n  title: Android Dalvik VM executable (dex)\n  file-extension: dex\n  xref:\n    justsolve: Dalvik_Executable\n    pronom: fmt/694\n    wikidata: Q29000585\n  tags:\n    - android\n    - executable\n  license: Apache-2.0\n  imports:\n    - /common/vlq_base128_le\n  endian: le\ndoc: |\n  Android OS applications executables are typically stored in its own\n  format, optimized for more efficient execution in Dalvik virtual\n  machine.\n\n  This format is loosely similar to Java .class file format and\n  generally holds the similar set of data: i.e. classes, methods,\n  fields, annotations, etc.\ndoc-ref: https://source.android.com/docs/core/runtime/dex-format\nseq:\n  - id: header\n    type: header_item\ninstances:\n  string_ids:\n    pos: header.string_ids_off\n    type: string_id_item\n    repeat: expr\n    repeat-expr: header.string_ids_size\n    doc: |\n      string identifiers list.\n\n      These are identifiers for all the strings used by this file, either for\n      internal naming (e.g., type descriptors) or as constant objects referred to by code.\n\n      This list must be sorted by string contents, using UTF-16 code point values\n      (not in a locale-sensitive manner), and it must not contain any duplicate entries.\n  type_ids:\n    pos: header.type_ids_off\n    type: type_id_item\n    repeat: expr\n    repeat-expr: header.type_ids_size\n    doc: |\n      type identifiers list.\n\n      These are identifiers for all types (classes, arrays, or primitive types)\n      referred to by this file, whether defined in the file or not.\n\n      This list must be sorted by string_id index, and it must not contain any duplicate entries.\n  proto_ids:\n    pos: header.proto_ids_off\n    type: proto_id_item\n    repeat: expr\n    repeat-expr: header.proto_ids_size\n    doc: |\n      method prototype identifiers list.\n\n      These are identifiers for all prototypes referred to by this file.\n\n      This list must be sorted in return-type (by type_id index) major order,\n      and then by argument list (lexicographic ordering, individual arguments\n      ordered by type_id index). The list must not contain any duplicate entries.\n  field_ids:\n    pos: header.field_ids_off\n    type: field_id_item\n    repeat: expr\n    repeat-expr: header.field_ids_size\n    doc: |\n      field identifiers list.\n\n      These are identifiers for all fields referred to by this file, whether defined in the file or not.\n\n      This list must be sorted, where the defining type (by type_id index)\n      is the major order, field name (by string_id index) is the intermediate\n      order, and type (by type_id index) is the minor order.\n\n      The list must not contain any duplicate entries.\n  method_ids:\n    pos: header.method_ids_off\n    type: method_id_item\n    repeat: expr\n    repeat-expr: header.method_ids_size\n    doc: |\n      method identifiers list.\n\n      These are identifiers for all methods referred to by this file,\n      whether defined in the file or not.\n\n      This list must be sorted, where the defining type (by type_id index\n      is the major order, method name (by string_id index) is the intermediate\n      order, and method prototype (by proto_id index) is the minor order.\n\n      The list must not contain any duplicate entries.\n  class_defs:\n    pos: header.class_defs_off\n    type: class_def_item\n    repeat: expr\n    repeat-expr: header.class_defs_size\n    doc: |\n      class definitions list.\n\n      The classes must be ordered such that a given class's superclass and\n      implemented interfaces appear in the list earlier than the referring class.\n\n      Furthermore, it is invalid for a definition for the same-named class to\n      appear more than once in the list.\n  #call_site_ids:\n  #  pos: header.???\n  #  type: call_site_id_item\n  #  repeat: expr\n  #  repeat-expr: header.???\n  #  doc: |\n  #    call site identifiers list.\n  #\n  #    These are identifiers for all call sites referred to by this file,\n  #    whether defined in the file or not.\n  #\n  #    This list must be sorted in ascending order of call_site_off.\n  link_data:\n    pos: header.link_off\n    size: header.link_size\n    doc: |\n      data used in statically linked files.\n\n      The format of the data in this section is left unspecified by this document.\n\n      This section is empty in unlinked files, and runtime implementations may\n      use it as they see fit.\n  data:\n    pos: header.data_off\n    size: header.data_size\n    doc: |\n      data area, containing all the support data for the tables listed above.\n\n      Different items have different alignment requirements, and padding bytes\n      are inserted before each item if necessary to achieve proper alignment.\n  map:\n    pos: header.map_off\n    type: map_list\ntypes:\n  header_item:\n    seq:\n      - id: magic\n        contents: \"dex\\n\"\n      - id: version_str\n        size: 4\n        type: strz\n        encoding: ascii\n      - id: checksum\n        type: u4\n        doc: |\n          adler32 checksum of the rest of the file (everything but magic and this field);\n          used to detect file corruption\n      - id: signature\n        size: 20\n        doc: |\n          SHA-1 signature (hash) of the rest of the file (everything but magic, checksum,\n          and this field); used to uniquely identify files\n      - id: file_size\n        type: u4\n        doc: |\n          size of the entire file (including the header), in bytes\n      - id: header_size\n        type: u4\n        # guard: 0x70\n        doc: |\n          size of the header (this entire section), in bytes. This allows for at\n          least a limited amount of backwards/forwards compatibility without\n          invalidating the format.\n      - id: endian_tag\n        type: u4\n        enum: endian_constant\n      - id: link_size\n        type: u4\n        doc: |\n          size of the link section, or 0 if this file isn't statically linked\n      - id: link_off\n        type: u4\n        doc: |\n          offset from the start of the file to the link section, or 0 if link_size == 0.\n          The offset, if non-zero, should be to an offset into the link_data section.\n          The format of the data pointed at is left unspecified by this document;\n          this header field (and the previous) are left as hooks for use by runtime implementations.\n      - id: map_off\n        type: u4\n        doc: |\n          offset from the start of the file to the map item.\n          The offset, which must be non-zero, should be to an offset into the data\n          section, and the data should be in the format specified by \"map_list\" below.\n      - id: string_ids_size\n        type: u4\n        doc: |\n          count of strings in the string identifiers list\n      - id: string_ids_off\n        type: u4\n        doc: |\n          offset from the start of the file to the string identifiers list,\n          or 0 if string_ids_size == 0 (admittedly a strange edge case).\n          The offset, if non-zero, should be to the start of the string_ids section.\n      - id: type_ids_size\n        type: u4\n        doc: |\n          count of elements in the type identifiers list, at most 65535\n      - id: type_ids_off\n        type: u4\n        doc: |\n          offset from the start of the file to the type identifiers list,\n          or 0 if type_ids_size == 0 (admittedly a strange edge case).\n          The offset, if non-zero, should be to the start of the type_ids section.\n      - id: proto_ids_size\n        type: u4\n        doc: |\n          count of elements in the prototype identifiers list, at most 65535\n      - id: proto_ids_off\n        type: u4\n        doc: |\n          offset from the start of the file to the prototype identifiers list,\n          or 0 if proto_ids_size == 0 (admittedly a strange edge case).\n          The offset, if non-zero, should be to the start of the proto_ids section.\n      - id: field_ids_size\n        type: u4\n        doc: |\n          count of elements in the field identifiers list\n      - id: field_ids_off\n        type: u4\n        doc: |\n          offset from the start of the file to the field identifiers list,\n          or 0 if field_ids_size == 0.\n          The offset, if non-zero, should be to the start of the field_ids section.\n      - id: method_ids_size\n        type: u4\n        doc: |\n          count of elements in the method identifiers list\n      - id: method_ids_off\n        type: u4\n        doc: |\n          offset from the start of the file to the method identifiers list,\n          or 0 if method_ids_size == 0.\n          The offset, if non-zero, should be to the start of the method_ids section.\n      - id: class_defs_size\n        type: u4\n        doc: |\n          count of elements in the class definitions list\n      - id: class_defs_off\n        type: u4\n        doc: |\n          offset from the start of the file to the class definitions list,\n          or 0 if class_defs_size == 0 (admittedly a strange edge case).\n          The offset, if non-zero, should be to the start of the class_defs section.\n      - id: data_size\n        type: u4\n        doc: |\n          Size of data section in bytes. Must be an even multiple of sizeof(uint).\n      - id: data_off\n        type: u4\n        doc: |\n          offset from the start of the file to the start of the data section.\n    enums:\n      endian_constant:\n        0x12345678: endian_constant\n        0x78563412: reverse_endian_constant\n  string_id_item:\n    -webide-representation: \"{value.data} (offs={string_data_off})\"\n    seq:\n      - id: string_data_off\n        type: u4\n        doc: |\n          offset from the start of the file to the string data for this item.\n          The offset should be to a location in the data section, and the data\n          should be in the format specified by \"string_data_item\" below.\n          There is no alignment requirement for the offset.\n    types:\n      string_data_item:\n        -webide-representation: \"{data}\"\n        seq:\n          - id: utf16_size\n            type: vlq_base128_le\n          - id: data\n            size: utf16_size.value\n            type: str\n            encoding: ascii\n    instances:\n      value:\n        pos: string_data_off\n        type: string_data_item\n        -webide-parse-mode: eager\n  type_id_item:\n    -webide-representation: \"{type_name}\"\n    seq:\n      - id: descriptor_idx\n        type: u4\n        doc: |\n          index into the string_ids list for the descriptor string of this type.\n          The string must conform to the syntax for TypeDescriptor, defined above.\n    instances:\n      type_name:\n        value: _root.string_ids[descriptor_idx].value.data\n        -webide-parse-mode: eager\n  proto_id_item:\n    -webide-representation: \"shorty_idx={shorty_idx} return_type_idx={return_type_idx} parameters_off={parameters_off}\"\n    seq:\n      - id: shorty_idx\n        type: u4\n        doc: |\n          index into the string_ids list for the short-form descriptor string of this prototype.\n          The string must conform to the syntax for ShortyDescriptor, defined above,\n          and must correspond to the return type and parameters of this item.\n      - id: return_type_idx\n        type: u4\n        doc: |\n          index into the type_ids list for the return type of this prototype\n      - id: parameters_off\n        type: u4\n        doc: |\n          offset from the start of the file to the list of parameter types for this prototype,\n          or 0 if this prototype has no parameters.\n          This offset, if non-zero, should be in the data section, and the data\n          there should be in the format specified by \"type_list\" below.\n          Additionally, there should be no reference to the type void in the list.\n    instances:\n      shorty_desc:\n        value: _root.string_ids[shorty_idx].value.data\n        doc: short-form descriptor string of this prototype, as pointed to by shorty_idx\n      params_types:\n        io: _root._io\n        pos: parameters_off\n        type: type_list\n        if: parameters_off != 0\n        doc: list of parameter types for this prototype\n      return_type:\n        value: _root.type_ids[return_type_idx].type_name\n        doc: return type of this prototype\n  field_id_item:\n    -webide-representation: \"class_idx={class_idx} type_idx={type_idx} name_idx={name_idx}\"\n    seq:\n      - id: class_idx\n        type: u2\n        doc: |\n          index into the type_ids list for the definer of this field.\n          This must be a class type, and not an array or primitive type.\n      - id: type_idx\n        type: u2\n        doc: |\n          index into the type_ids list for the type of this field\n      - id: name_idx\n        type: u4\n        doc: |\n          index into the string_ids list for the name of this field.\n          The string must conform to the syntax for MemberName, defined above.\n    instances:\n      class_name:\n        value: _root.type_ids[class_idx].type_name\n        doc: the definer of this field\n      type_name:\n        value: _root.type_ids[type_idx].type_name\n        doc: the type of this field\n      field_name:\n        value: _root.string_ids[name_idx].value.data\n        doc: the name of this field\n  method_id_item:\n    -webide-representation: \"class_idx={class_idx} proto_idx={proto_idx} name_idx={name_idx}\"\n    seq:\n      - id: class_idx\n        type: u2\n        doc: |\n          index into the type_ids list for the definer of this method.\n          This must be a class or array type, and not a primitive type.\n      - id: proto_idx\n        type: u2\n        doc: |\n          index into the proto_ids list for the prototype of this method\n      - id: name_idx\n        type: u4\n        doc: |\n          index into the string_ids list for the name of this method.\n          The string must conform to the syntax for MemberName, defined above.\n    instances:\n      class_name:\n        value: _root.type_ids[class_idx].type_name\n        doc: the definer of this method\n      proto_desc:\n        value: _root.proto_ids[proto_idx].shorty_desc\n        doc: the short-form descriptor of the prototype of this method\n      method_name:\n        value: _root.string_ids[name_idx].value.data\n        doc: the name of this method\n  class_def_item:\n    -webide-representation: \"{access_flags} {type_name}\"\n    seq:\n      - id: class_idx\n        type: u4\n        doc: |\n          index into the type_ids list for this class.\n\n          This must be a class type, and not an array or primitive type.\n      - id: access_flags\n        type: u4\n        enum: class_access_flags\n        doc: |\n          access flags for the class (public, final, etc.).\n\n          See \"access_flags Definitions\" for details.\n      - id: superclass_idx\n        type: u4\n        doc: |\n          index into the type_ids list for the superclass,\n          or the constant value NO_INDEX if this class has no superclass\n          (i.e., it is a root class such as Object).\n\n          If present, this must be a class type, and not an array or primitive type.\n      - id: interfaces_off\n        type: u4\n        doc: |\n          offset from the start of the file to the list of interfaces, or 0 if there are none.\n\n          This offset should be in the data section, and the data there should\n          be in the format specified by \"type_list\" below. Each of the elements\n          of the list must be a class type (not an array or primitive type),\n          and there must not be any duplicates.\n      - id: source_file_idx\n        type: u4\n        doc: |\n          index into the string_ids list for the name of the file containing\n          the original source for (at least most of) this class, or the\n          special value NO_INDEX to represent a lack of this information.\n\n          The debug_info_item of any given method may override this source file,\n          but the expectation is that most classes will only come from one source file.\n      - id: annotations_off\n        type: u4\n        doc: |\n          offset from the start of the file to the annotations structure for\n          this class, or 0 if there are no annotations on this class.\n\n          This offset, if non-zero, should be in the data section, and the data\n          there should be in the format specified by \"annotations_directory_item\"\n          below,with all items referring to this class as the definer.\n      - id: class_data_off\n        type: u4\n        doc: |\n          offset from the start of the file to the associated class data for this\n          item, or 0 if there is no class data for this class.\n\n          (This may be the case, for example, if this class is a marker interface.)\n\n          The offset, if non-zero, should be in the data section, and the data\n          there should be in the format specified by \"class_data_item\" below,\n          with all items referring to this class as the definer.\n      - id: static_values_off\n        type: u4\n        doc: |\n          offset from the start of the file to the list of initial values for\n          static fields, or 0 if there are none (and all static fields are to be\n          initialized with 0 or null).\n\n          This offset should be in the data section, and the data there should\n          be in the format specified by \"encoded_array_item\" below.\n\n          The size of the array must be no larger than the number of static fields\n          declared by this class, and the elements correspond to the static fields\n          in the same order as declared in the corresponding field_list.\n\n          The type of each array element must match the declared type of its\n          corresponding field.\n\n          If there are fewer elements in the array than there are static fields,\n          then the leftover fields are initialized with a type-appropriate 0 or null.\n    instances:\n      type_name:\n        value: _root.type_ids[class_idx].type_name\n        -webide-parse-mode: eager\n      class_data:\n        pos: class_data_off\n        type: class_data_item\n        if: class_data_off != 0\n      static_values:\n        pos: static_values_off\n        type: encoded_array_item\n        if: static_values_off != 0\n  encoded_array_item:\n    seq:\n      - id: value\n        type: encoded_array\n  annotation_element:\n    seq:\n      - id: name_idx\n        type: vlq_base128_le\n        doc: |\n          element name, represented as an index into the string_ids section.\n\n          The string must conform to the syntax for MemberName, defined above.\n      - id: value\n        type: encoded_value\n        doc: |\n          element value\n  encoded_annotation:\n    seq:\n      - id: type_idx\n        type: vlq_base128_le\n        doc: |\n          type of the annotation.\n\n          This must be a class (not array or primitive) type.\n      - id: size\n        type: vlq_base128_le\n        doc: |\n          number of name-value mappings in this annotation\n      - id: elements\n        type: annotation_element\n        repeat: expr\n        repeat-expr: size.value\n        doc: |\n          elements of the annotation, represented directly in-line (not as offsets).\n\n          Elements must be sorted in increasing order by string_id index.\n  encoded_value:\n    -webide-representation: \"{value_type}: {value} (arg={value_arg})\"\n    seq:\n      - id: value_arg\n        type: b3\n      - id: value_type\n        type: b5\n        enum: value_type_enum\n      - id: value\n        type:\n          switch-on: value_type\n          cases:\n            # TODO: dynamic sizes\n            value_type_enum::byte:          s1\n            value_type_enum::short:         s2\n            value_type_enum::char:          u2\n            value_type_enum::int:           s4\n            value_type_enum::long:          s8\n            value_type_enum::float:         f4\n            value_type_enum::double:        f8\n            value_type_enum::method_type:   u4\n            value_type_enum::method_handle: u4\n            value_type_enum::string:        u4\n            value_type_enum::type:          u4\n            value_type_enum::field:         u4\n            value_type_enum::method:        u4\n            value_type_enum::enum:          u4\n            value_type_enum::array:         encoded_array\n            value_type_enum::annotation:    encoded_annotation\n    enums:\n      value_type_enum:\n        0x00: byte\n        0x02: short\n        0x03: char\n        0x04: int\n        0x06: long\n        0x10: float\n        0x11: double\n        0x15: method_type\n        0x16: method_handle\n        0x17: string\n        0x18: type\n        0x19: field\n        0x1a: method\n        0x1b: enum\n        0x1c: array\n        0x1d: annotation\n        0x1e: \"null\"\n        0x1f: boolean\n  encoded_array:\n    seq:\n      - id: size\n        type: vlq_base128_le\n      - id: values\n        type: encoded_value\n        repeat: expr\n        repeat-expr: size.value\n  call_site_id_item:\n    seq:\n      - id: call_site_off\n        type: u4\n        doc: |\n          offset from the start of the file to call site definition.\n\n          The offset should be in the data section, and the data there should\n          be in the format specified by \"call_site_item\" below.\n  encoded_field:\n    seq:\n      - id: field_idx_diff\n        type: vlq_base128_le\n        doc: |\n          index into the field_ids list for the identity of this field\n          (includes the name and descriptor), represented as a difference\n          from the index of previous element in the list.\n\n          The index of the first element in a list is represented directly.\n      - id: access_flags\n        type: vlq_base128_le\n        doc: |\n          access flags for the field (public, final, etc.).\n\n          See \"access_flags Definitions\" for details.\n  encoded_method:\n    seq:\n      - id: method_idx_diff\n        type: vlq_base128_le\n        doc: |\n          index into the method_ids list for the identity of this method\n          (includes the name and descriptor), represented as a difference\n          from the index of previous element in the list.\n\n          The index of the first element in a list is represented directly.\n      - id: access_flags\n        type: vlq_base128_le\n        doc: |\n          access flags for the field (public, final, etc.).\n\n          See \"access_flags Definitions\" for details.\n      - id: code_off\n        type: vlq_base128_le\n        doc: |\n          offset from the start of the file to the code structure for this method,\n          or 0 if this method is either abstract or native.\n\n          The offset should be to a location in the data section.\n\n          The format of the data is specified by \"code_item\" below.\n  class_data_item:\n    seq:\n      - id: static_fields_size\n        type: vlq_base128_le\n        doc: |\n          the number of static fields defined in this item\n      - id: instance_fields_size\n        type: vlq_base128_le\n        doc: |\n          the number of instance fields defined in this item\n      - id: direct_methods_size\n        type: vlq_base128_le\n        doc: |\n          the number of direct methods defined in this item\n      - id: virtual_methods_size\n        type: vlq_base128_le\n        doc: |\n          the number of virtual methods defined in this item\n      - id: static_fields\n        type: encoded_field\n        repeat: expr\n        repeat-expr: static_fields_size.value\n        doc: |\n          the defined static fields, represented as a sequence of encoded elements.\n\n          The fields must be sorted by field_idx in increasing order.\n      - id: instance_fields\n        type: encoded_field\n        repeat: expr\n        repeat-expr: instance_fields_size.value\n        doc: |\n          the defined instance fields, represented as a sequence of encoded elements.\n\n          The fields must be sorted by field_idx in increasing order.\n      - id: direct_methods\n        type: encoded_method\n        repeat: expr\n        repeat-expr: direct_methods_size.value\n        doc: |\n          the defined direct (any of static, private, or constructor) methods,\n          represented as a sequence of encoded elements.\n\n          The methods must be sorted by method_idx in increasing order.\n      - id: virtual_methods\n        type: encoded_method\n        repeat: expr\n        repeat-expr: virtual_methods_size.value\n        doc: |\n          the defined virtual (none of static, private, or constructor) methods,\n          represented as a sequence of encoded elements.\n\n          This list should not include inherited methods unless overridden by\n          the class that this item represents.\n\n          The methods must be sorted by method_idx in increasing order.\n\n          The method_idx of a virtual method must not be the same as any direct method.\n  map_item:\n    -webide-representation: \"{type}: offs={offset}, size={size}\"\n    seq:\n      - id: type\n        type: u2\n        enum: map_item_type\n        doc: |\n          type of the items; see table below\n      - id: unused\n        type: u2\n        doc: |\n          (unused)\n      - id: size\n        type: u4\n        doc: |\n          count of the number of items to be found at the indicated offset\n      - id: offset\n        type: u4\n        doc: |\n          offset from the start of the file to the items in question\n    enums:\n      map_item_type:\n        0x0000: header_item\n        0x0001: string_id_item\n        0x0002: type_id_item\n        0x0003: proto_id_item\n        0x0004: field_id_item\n        0x0005: method_id_item\n        0x0006: class_def_item\n        0x0007: call_site_id_item\n        0x0008: method_handle_item\n        0x1000: map_list\n        0x1001: type_list\n        0x1002: annotation_set_ref_list\n        0x1003: annotation_set_item\n        0x2000: class_data_item\n        0x2001: code_item\n        0x2002: string_data_item\n        0x2003: debug_info_item\n        0x2004: annotation_item\n        0x2005: encoded_array_item\n        0x2006: annotations_directory_item\n  map_list:\n    seq:\n      - id: size\n        type: u4\n      - id: list\n        type: map_item\n        repeat: expr\n        repeat-expr: size\n  type_item:\n    seq:\n      - id: type_idx\n        type: u2\n    instances:\n      value:\n        value: _root.type_ids[type_idx].type_name\n  type_list:\n    seq:\n      - id: size\n        type: u4\n      - id: list\n        type: type_item\n        repeat: expr\n        repeat-expr: size\nenums:\n  class_access_flags:\n    0x0001: public     # public: visible everywhere\n    0x0002: private    # * private: only visible to defining class\n    0x0004: protected  # * protected: visible to package and subclasses\n    0x0008: static     # * static: is not constructed with an outer this reference\n    0x0010: final      # final: not subclassable\n    0x0200: interface  # interface: multiply-implementable abstract class\n    0x0400: abstract   # abstract: not directly instantiable\n    0x1000: synthetic  # not directly defined in source code\n    0x2000: annotation # declared as an annotation class\n    0x4000: enum       # declared as an enumerated type\n"
  },
  {
    "id": "ksy_dos_mz",
    "name": "DOS MZ executable",
    "category": "Executable",
    "metadata": {
      "isGenerated": true,
      "fileExtensions": [
        "exe",
        "ovl"
      ],
      "description": "DOS MZ executable",
      "originalCategory": "executable",
      "filePath": "executable/dos_mz.ksy",
      "endian": "le"
    },
    "content": "meta:\n  id: dos_mz\n  title: DOS MZ executable\n  file-extension:\n    - exe\n    - ovl\n  xref:\n    justsolve: MS-DOS_EXE\n    pronom: x-fmt/409\n    wikidata: Q1882110\n  tags:\n    - dos\n  license: CC0-1.0\n  ks-version: 0.9\n  encoding: ASCII\n  endian: le\ndoc: |\n  DOS MZ file format is a traditional format for executables in MS-DOS\n  environment. Many modern formats (i.e. Windows PE) still maintain\n  compatibility stub with this format.\n\n  As opposed to .com file format (which basically sports one 64K code\n  segment of raw CPU instructions), DOS MZ .exe file format allowed\n  more flexible memory management, loading of larger programs and\n  added support for relocations.\ndoc-ref: http://www.delorie.com/djgpp/doc/exe/\nseq:\n  - id: header\n    type: exe_header\n  - id: body\n    size: header.len_body\ninstances:\n  relocations:\n    pos: header.mz.ofs_relocations\n    io: header._io\n    type: relocation\n    repeat: expr\n    repeat-expr: header.mz.num_relocations\n    if: header.mz.ofs_relocations != 0\ntypes:\n  exe_header:\n    seq:\n      - id: mz\n        type: mz_header\n      - id: rest_of_header\n        size: mz.len_header - mz._sizeof\n    instances:\n      len_body:\n        value: '(mz.last_page_extra_bytes == 0 ? mz.num_pages * 512 : (mz.num_pages - 1) * 512 + mz.last_page_extra_bytes) - mz.len_header'\n  mz_header:\n    seq:\n      - id: magic\n        size: 2\n        type: str\n        valid:\n          any-of:\n            - '\"MZ\"'\n            - '\"ZM\"'\n      - id: last_page_extra_bytes\n        type: u2\n      - id: num_pages\n        type: u2\n      - id: num_relocations\n        type: u2\n      - id: header_size\n        type: u2\n      - id: min_allocation\n        type: u2\n      - id: max_allocation\n        type: u2\n      - id: initial_ss\n        type: u2\n      - id: initial_sp\n        type: u2\n      - id: checksum\n        type: u2\n      - id: initial_ip\n        type: u2\n      - id: initial_cs\n        type: u2\n      - id: ofs_relocations\n        type: u2\n      - id: overlay_id\n        type: u2\n    instances:\n      len_header:\n        value: header_size * 16\n  relocation:\n    seq:\n      - id: ofs\n        type: u2\n      - id: seg\n        type: u2\n"
  },
  {
    "id": "ksy_elf",
    "name": "Executable and Linkable Format",
    "category": "Executable",
    "metadata": {
      "isGenerated": true,
      "fileExtensions": [],
      "description": "Executable and Linkable Format",
      "originalCategory": "executable",
      "filePath": "executable/elf.ksy",
      "signature": {
        "offset": 0,
        "bytes": [
          127,
          14
        ]
      }
    },
    "content": "meta:\n  id: elf\n  title: Executable and Linkable Format\n  application: SVR4 ABI and up, many *nix systems\n  xref:\n    justsolve: Executable_and_Linkable_Format\n    mime:\n      - application/x-elf\n      - application/x-coredump\n      - application/x-executable\n      - application/x-object\n      - application/x-sharedlib\n    pronom:\n      - fmt/688 # 32bit Little Endian\n      - fmt/689 # 32bit Big Endian\n      - fmt/690 # 64bit Little Endian\n      - fmt/691 # 64bit Big Endian\n    wikidata: Q1343830\n  tags:\n    - executable\n    - linux\n  license: CC0-1.0\n  ks-version: 0.9\ndoc-ref:\n  - https://sourceware.org/git/?p=glibc.git;a=blob;f=elf/elf.h;hb=0f62fe0532\n  - https://refspecs.linuxfoundation.org/elf/gabi4+/contents.html\n  - https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/elf-application-binary-interface.html\nseq:\n  - id: magic\n    -orig-id: e_ident[EI_MAG0]..e_ident[EI_MAG3]\n    size: 4\n    contents: [0x7f, \"ELF\"]\n    doc: File identification, must be 0x7f + \"ELF\".\n  - id: bits\n    -orig-id: e_ident[EI_CLASS]\n    type: u1\n    enum: bits\n    doc: |\n      File class: designates target machine word size (32 or 64\n      bits). The size of many integer fields in this format will\n      depend on this setting.\n  - id: endian\n    -orig-id: e_ident[EI_DATA]\n    type: u1\n    enum: endian\n    doc: Endianness used for all integers.\n  - id: ei_version\n    -orig-id: e_ident[EI_VERSION]\n    type: u1\n    valid: 1\n    doc: ELF header version.\n  - id: abi\n    -orig-id: e_ident[EI_OSABI]\n    type: u1\n    enum: os_abi\n    doc: |\n      Specifies which OS- and ABI-related extensions will be used\n      in this ELF file.\n  - id: abi_version\n    -orig-id: e_ident[EI_ABIVERSION]\n    type: u1\n    doc: |\n      Version of ABI targeted by this ELF file. Interpretation\n      depends on `abi` attribute.\n  - id: pad\n    -orig-id: e_ident[EI_PAD]..e_ident[EI_NIDENT - 1]\n    contents: [0, 0, 0, 0, 0, 0, 0]\n  - id: header\n    type: endian_elf\ninstances:\n  sh_idx_lo_reserved:\n    -orig-id: SHN_LORESERVE\n    value: 0xff00\n  sh_idx_lo_proc:\n    -orig-id: SHN_LOPROC\n    value: 0xff00\n  sh_idx_hi_proc:\n    -orig-id: SHN_HIPROC\n    value: 0xff1f\n  sh_idx_lo_os:\n    -orig-id: SHN_LOOS\n    value: 0xff20\n  sh_idx_hi_os:\n    -orig-id: SHN_HIOS\n    value: 0xff3f\n  sh_idx_hi_reserved:\n    -orig-id: SHN_HIRESERVE\n    value: 0xffff\ntypes:\n  phdr_type_flags:\n    params:\n      - id: value\n        type: u4\n    instances:\n      read:\n        value: value & 0x04 != 0\n      write:\n        value: value & 0x02 != 0\n      execute:\n        value: value & 0x01 != 0\n      mask_proc:\n        value: value & 0xf0000000 != 0\n  section_header_flags:\n    params:\n      - id: value\n        type: u4\n    instances:\n      write:\n        value: value & 0x01 != 0\n        doc: \"writable\"\n      alloc:\n        value: value & 0x02 != 0\n        doc: \"occupies memory during execution\"\n      exec_instr:\n        value: value & 0x04 != 0\n        doc: \"executable\"\n      merge:\n        value: value & 0x10 != 0\n        doc: \"might be merged\"\n      strings:\n        value: value & 0x20 != 0\n        doc: \"contains nul-terminated strings\"\n      info_link:\n        value: value & 0x40 != 0\n        doc: \"'sh_info' contains SHT index\"\n      link_order:\n        value: value & 0x80 != 0\n        doc: \"preserve order after combining\"\n      os_non_conforming:\n        value: value & 0x100 != 0\n        doc: \"non-standard OS specific handling required\"\n      group:\n        value: value & 0x200 != 0\n        doc: \"section is member of a group\"\n      tls:\n        value: value & 0x400 != 0\n        doc: \"section hold thread-local data\"\n      ordered:\n        value: value & 0x04000000 != 0\n        doc: \"special ordering requirement (Solaris)\"\n      exclude:\n        value: value & 0x08000000 != 0\n        doc: \"section is excluded unless referenced or allocated (Solaris)\"\n      mask_os:\n        value: value & 0x0ff00000 != 0\n        doc: \"OS-specific\"\n      mask_proc:\n        value: value & 0xf0000000 != 0\n        doc: \"Processor-specific\"\n  dt_flag_values:\n    doc-ref:\n      - 'https://refspecs.linuxbase.org/elf/gabi4+/ch5.dynamic.html Figure 5-11: DT_FLAGS values'\n      - https://github.com/golang/go/blob/48dfddbab3/src/debug/elf/elf.go#L1079-L1095\n      - https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/dynamic-section.html#GUID-4336A69A-D905-4FCE-A398-80375A9E6464__CHAPTER7-TBL-5\n    params:\n      - id: value\n        type: u4\n    instances:\n      origin:\n        value: value & 0x00000001 != 0\n        doc: object may reference the $ORIGIN substitution string\n      symbolic:\n        value: value & 0x00000002 != 0\n        doc: symbolic linking\n      textrel:\n        value: value & 0x00000004 != 0\n        doc: relocation entries might request modifications to a non-writable segment\n      bind_now:\n        value: value & 0x00000008 != 0\n        doc: |\n          all relocations for this object must be processed before returning\n          control to the program\n      static_tls:\n        value: value & 0x00000010 != 0\n        doc: object uses static thread-local storage scheme\n  dt_flag_1_values:\n    params:\n      - id: value\n        type: u4\n    instances:\n      now:\n        value: value & 0x00000001 != 0\n        doc: \"Set RTLD_NOW for this object.\"\n      rtld_global:\n        value: value & 0x00000002 != 0\n        doc: \"Set RTLD_GLOBAL for this object.\"\n      group:\n        value: value & 0x00000004 != 0\n        doc: \"Set RTLD_GROUP for this object.\"\n      nodelete:\n        value: value & 0x00000008 != 0\n        doc: \"Set RTLD_NODELETE for this object.\"\n      loadfltr:\n        value: value & 0x00000010 != 0\n        doc: \"Trigger filtee loading at runtime.\"\n      initfirst:\n        value: value & 0x00000020 != 0\n        doc: \"Set RTLD_INITFIRST for this object\"\n      noopen:\n        value: value & 0x00000040 != 0\n        doc: \"Set RTLD_NOOPEN for this object.\"\n      origin:\n        value: value & 0x00000080 != 0\n        doc: \"$ORIGIN must be handled.\"\n      direct:\n        value: value & 0x00000100 != 0\n        doc: \"Direct binding enabled.\"\n      trans:\n        value: value & 0x00000200 != 0\n      interpose:\n        value: value & 0x00000400 != 0\n        doc: \"Object is used to interpose.\"\n      nodeflib:\n        value: value & 0x00000800 != 0\n        doc: \"Ignore default lib search path.\"\n      nodump:\n        value: value & 0x00001000 != 0\n        doc: \"Object can't be dldump'ed.\"\n      confalt:\n        value: value & 0x00002000 != 0\n        doc: \"Configuration alternative created.\"\n      endfiltee:\n        value: value & 0x00004000 != 0\n        doc: \"Filtee terminates filters search.\"\n      dispreldne:\n        value: value & 0x00008000 != 0\n        doc: \"Disp reloc applied at build time.\"\n      disprelpnd:\n        value: value & 0x00010000 != 0\n        doc: \"Disp reloc applied at run-time.\"\n      nodirect:\n        value: value & 0x00020000 != 0\n        doc: \"Object has no-direct binding.\"\n      ignmuldef:\n        value: value & 0x00040000 != 0\n      noksyms:\n        value: value & 0x00080000 != 0\n      nohdr:\n        value: value & 0x00100000 != 0\n      edited:\n        value: value & 0x00200000 != 0\n        doc: \"Object is modified after built.\"\n      noreloc:\n        value: value & 0x00400000 != 0\n      symintpose:\n        value: value & 0x00800000 != 0\n        doc: \"Object has individual interposers.\"\n      globaudit:\n        value: value & 0x01000000 != 0\n        doc: \"Global auditing required.\"\n      singleton:\n        value: value & 0x02000000 != 0\n        doc: \"Singleton symbols are used.\"\n      stub:\n        value: value & 0x04000000 != 0\n      pie:\n        value: value & 0x08000000 != 0\n  endian_elf:\n    meta:\n      endian:\n        switch-on: _root.endian\n        cases:\n          'endian::le': le\n          'endian::be': be\n    seq:\n      - id: e_type\n        type: u2\n        enum: obj_type\n      - id: machine\n        type: u2\n        enum: machine\n      - id: e_version\n        type: u4\n      # e_entry\n      - id: entry_point\n        type:\n          switch-on: _root.bits\n          cases:\n            'bits::b32': u4\n            'bits::b64': u8\n      # e_phoff\n      - id: ofs_program_headers\n        type:\n          switch-on: _root.bits\n          cases:\n            'bits::b32': u4\n            'bits::b64': u8\n      # e_shoff\n      - id: ofs_section_headers\n        type:\n          switch-on: _root.bits\n          cases:\n            'bits::b32': u4\n            'bits::b64': u8\n      # e_flags\n      - id: flags\n        size: 4\n      # e_ehsize\n      - id: e_ehsize\n        type: u2\n      # e_phentsize\n      - id: program_header_size\n        type: u2\n      # e_phnum\n      - id: num_program_headers\n        type: u2\n      # e_shentsize\n      - id: section_header_size\n        type: u2\n      # e_shnum\n      - id: num_section_headers\n        type: u2\n      # e_shstrndx\n      - id: section_names_idx\n        type: u2\n    types:\n      # Elf(32|64)_Phdr\n      program_header:\n        seq:\n          # p_type\n          - id: type\n            type: u4\n            enum: ph_type\n          # p_flags\n          - id: flags64\n            type: u4\n            if: _root.bits == bits::b64\n          # p_offset\n          - id: offset\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          # p_vaddr\n          - id: vaddr\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          # p_paddr\n          - id: paddr\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          # p_filesz\n          - id: filesz\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          # p_memsz\n          - id: memsz\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          # p_flags\n          - id: flags32\n            type: u4\n            if: _root.bits == bits::b32\n          # p_align\n          - id: align\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n        instances:\n          flags_obj:\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': phdr_type_flags(flags32)\n                'bits::b64': phdr_type_flags(flags64)\n            -webide-parse-mode: eager\n        -webide-representation: \"{type} - f:{flags_obj:flags} (o:{offset}, s:{filesz:dec})\"\n      section_header:\n        -orig-id: Elf(32|64)_Shdr\n        seq:\n          - id: ofs_name\n            -orig-id: sh_name\n            type: u4\n          - id: type\n            -orig-id: sh_type\n            type: u4\n            enum: sh_type\n          - id: flags\n            -orig-id: sh_flags\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          - id: addr\n            -orig-id: sh_addr\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          - id: ofs_body\n            -orig-id: sh_offset\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          - id: len_body\n            -orig-id: sh_size\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          - id: linked_section_idx\n            -orig-id: sh_link\n            type: u4\n          - id: info\n            -orig-id: sh_info\n            size: 4\n          - id: align\n            -orig-id: sh_addralign\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          - id: entry_size\n            -orig-id: sh_entsize\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n        instances:\n          body:\n            io: _root._io\n            pos: ofs_body\n            size: len_body\n            type:\n              switch-on: type\n              cases:\n                'sh_type::dynamic': dynamic_section\n                'sh_type::strtab': strings_struct\n                'sh_type::dynsym': dynsym_section\n                'sh_type::symtab': dynsym_section\n                'sh_type::note': note_section\n                'sh_type::rel': relocation_section(false)\n                'sh_type::rela': relocation_section(true)\n            if: type != sh_type::nobits\n          linked_section:\n            value: _root.header.section_headers[linked_section_idx]\n            if: |\n              linked_section_idx != section_header_idx_special::undefined.to_i\n              and linked_section_idx < _root.header.num_section_headers\n            doc: may reference a later section header, so don't try to access too early (use only lazy `instances`)\n            doc-ref: https://refspecs.linuxfoundation.org/elf/gabi4+/ch4.sheader.html#sh_link\n          name:\n            io: _root.header.section_names._io\n            pos: ofs_name\n            type: strz\n            encoding: ASCII\n            -webide-parse-mode: eager\n          flags_obj:\n            type: section_header_flags(flags)\n            -webide-parse-mode: eager\n        -webide-representation: \"{name} ({type}) - f:{flags_obj:flags} (o:{offset}, s:{size:dec})\"\n      strings_struct:\n        seq:\n          - id: entries\n            type: strz\n            repeat: eos\n            # For an explanation of why UTF-8 instead of ASCII, see the comment\n            # on the `name` attribute in the `dynsym_section_entry` type.\n            encoding: UTF-8\n      dynamic_section:\n        seq:\n          - id: entries\n            type: dynamic_section_entry\n            repeat: eos\n        instances:\n          is_string_table_linked:\n            value: _parent.linked_section.type == sh_type::strtab\n      dynamic_section_entry:\n        doc-ref:\n          - https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/dynamic-section.html\n          - https://refspecs.linuxfoundation.org/elf/gabi4+/ch5.dynamic.html#dynamic_section\n        -webide-representation: \"{tag_enum}: {value_or_ptr} {value_str} {flag_1_values:flags}\"\n        seq:\n          - id: tag\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          - id: value_or_ptr\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n        instances:\n          tag_enum:\n            value: tag\n            enum: dynamic_array_tags\n          flag_values:\n            type: dt_flag_values(value_or_ptr)\n            if: \"tag_enum == dynamic_array_tags::flags\"\n            -webide-parse-mode: eager\n          flag_1_values:\n            type: dt_flag_1_values(value_or_ptr)\n            if: \"tag_enum == dynamic_array_tags::flags_1\"\n            -webide-parse-mode: eager\n          value_str:\n            io: _parent._parent.linked_section.body.as<strings_struct>._io\n            pos: value_or_ptr\n            type: strz\n            encoding: ASCII\n            if: is_value_str and _parent.is_string_table_linked\n            -webide-parse-mode: eager\n          is_value_str:\n            value: |\n              value_or_ptr != 0 and (\n                tag_enum == dynamic_array_tags::needed or\n                tag_enum == dynamic_array_tags::soname or\n                tag_enum == dynamic_array_tags::rpath or\n                tag_enum == dynamic_array_tags::runpath or\n                tag_enum == dynamic_array_tags::sunw_auxiliary or\n                tag_enum == dynamic_array_tags::sunw_filter or\n                tag_enum == dynamic_array_tags::auxiliary or\n                tag_enum == dynamic_array_tags::filter or\n                tag_enum == dynamic_array_tags::config or\n                tag_enum == dynamic_array_tags::depaudit or\n                tag_enum == dynamic_array_tags::audit\n              )\n      dynsym_section:\n        seq:\n          - id: entries\n            type: dynsym_section_entry\n            repeat: eos\n        instances:\n          is_string_table_linked:\n            value: _parent.linked_section.type == sh_type::strtab\n      dynsym_section_entry:\n        -orig-id:\n          - Elf32_Sym\n          - Elf64_Sym\n        doc-ref:\n          - https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/symbol-table-section.html\n          - https://refspecs.linuxfoundation.org/elf/gabi4+/ch4.symtab.html\n        -webide-representation: 'v:{value} s:{size:dec} t:{type} b:{bind} vis:{visibility} i:{sh_idx:dec}[={sh_idx_special}] n:{name}'\n        seq:\n          - id: ofs_name\n            -orig-id: st_name\n            type: u4\n\n          - id: value_b32\n            type: u4\n            if: _root.bits == bits::b32\n          - id: size_b32\n            type: u4\n            if: _root.bits == bits::b32\n\n          - id: bind\n            -orig-id: ELF32_ST_BIND(st_info)\n            type: b4\n            enum: symbol_binding\n          - id: type\n            -orig-id: ELF32_ST_TYPE(st_info)\n            type: b4\n            enum: symbol_type\n          - id: other\n            type: u1\n            doc: don't read this field, access `visibility` instead\n          - id: sh_idx\n            -orig-id: st_shndx\n            type: u2\n            doc: section header index\n\n          - id: value_b64\n            type: u8\n            if: _root.bits == bits::b64\n          - id: size_b64\n            type: u8\n            if: _root.bits == bits::b64\n        instances:\n          value:\n            value: |\n              _root.bits == bits::b32 ? value_b32 :\n              _root.bits == bits::b64 ? value_b64 :\n              0\n          size:\n            value: |\n              _root.bits == bits::b32 ? size_b32 :\n              _root.bits == bits::b64 ? size_b64 :\n              0\n          name:\n            io: _parent._parent.linked_section.body.as<strings_struct>._io\n            pos: ofs_name\n            type: strz\n            # UTF-8 is used (instead of ASCII) because Golang binaries may\n            # contain specific Unicode code points in symbol identifiers.\n            #\n            # See\n            # * <https://go.dev/doc/asm#symbols>: \"the assembler allows the\n            #   middle dot character U+00B7 and the division slash U+2215 in\n            #   identifiers\"\n            # * <https://github.com/kaitai-io/kaitai_struct_formats/issues/520>\n            encoding: UTF-8\n            if: ofs_name != 0 and _parent.is_string_table_linked\n            -webide-parse-mode: eager\n          visibility:\n            value: other & 0x03\n            enum: symbol_visibility\n          sh_idx_special:\n            value: sh_idx\n            enum: section_header_idx_special\n          is_sh_idx_reserved:\n            value: |\n              sh_idx >= _root.sh_idx_lo_reserved and\n              sh_idx <= _root.sh_idx_hi_reserved\n          is_sh_idx_proc:\n            value: |\n              sh_idx >= _root.sh_idx_lo_proc and\n              sh_idx <= _root.sh_idx_hi_proc\n          is_sh_idx_os:\n            value: |\n              sh_idx >= _root.sh_idx_lo_os and\n              sh_idx <= _root.sh_idx_hi_os\n      note_section:\n        seq:\n          - id: entries\n            type: note_section_entry\n            repeat: eos\n      note_section_entry:\n        doc-ref:\n          - https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/note-section.html\n          # The following source claims that note's `name` and `descriptor` should be padded\n          # to 8 bytes in 64-bit ELFs, not always to 4 - although this seems to be an idea of\n          # the original spec, it did not catch on in the real world and most implementations\n          # always use 4-byte alignment - see\n          # <https://fa.linux.kernel.narkive.com/2Za5xb58/patch-01-02-elf-always-define-elf-addr-t-in-linux-elf-h#post13>\n          - https://refspecs.linuxfoundation.org/elf/gabi4+/ch5.pheader.html#note_section\n        seq:\n          - id: len_name\n            type: u4\n          - id: len_descriptor\n            type: u4\n          - id: type\n            type: u4\n          - id: name\n            size: len_name\n            terminator: 0\n            doc: |\n              Although the ELF specification seems to hint that the `note_name` field\n              is ASCII this isn't the case for Linux binaries that have a\n              `.gnu.build.attributes` section.\n            doc-ref: https://fedoraproject.org/wiki/Toolchain/Watermark#Proposed_Specification_for_non-loaded_notes\n          - id: name_padding\n            size: -len_name % 4\n          - id: descriptor\n            size: len_descriptor\n          - id: descriptor_padding\n            size: -len_descriptor % 4\n      relocation_section:\n        doc-ref:\n          - https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/relocation-sections.html\n          - https://refspecs.linuxfoundation.org/elf/gabi4+/ch4.reloc.html\n        params:\n          - id: has_addend\n            type: bool\n        seq:\n          - id: entries\n            type: relocation_section_entry\n            repeat: eos\n      relocation_section_entry:\n        seq:\n          - id: offset\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          - id: info\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': u4\n                'bits::b64': u8\n          - id: addend\n            type:\n              switch-on: _root.bits\n              cases:\n                'bits::b32': s4\n                'bits::b64': s8\n            if: _parent.has_addend\n    instances:\n      program_headers:\n        pos: ofs_program_headers\n        size: program_header_size\n        type: program_header\n        repeat: expr\n        repeat-expr: num_program_headers\n      section_headers:\n        pos: ofs_section_headers\n        size: section_header_size\n        type: section_header\n        repeat: expr\n        repeat-expr: num_section_headers\n      section_names:\n        pos: section_headers[section_names_idx].ofs_body\n        size: section_headers[section_names_idx].len_body\n        type: strings_struct\n        if: |\n          section_names_idx != section_header_idx_special::undefined.to_i\n          and section_names_idx < _root.header.num_section_headers\nenums:\n  # EI_CLASS\n  bits:\n    # ELFCLASS32\n    1: b32\n    # ELFCLASS64\n    2: b64\n  # EI_DATA\n  endian:\n    # ELFDATA2LSB\n    1: le\n    # ELFDATA2MSB\n    2: be\n  os_abi:\n    0: system_v\n    1: hp_ux\n    2: netbsd\n    3: gnu\n    6: solaris\n    7: aix\n    8: irix\n    9: freebsd\n    0xa: tru64 # Compaq TRU64 UNIX\n    0xb: modesto # Novell Modesto\n    0xc: openbsd\n    0xd: openvms\n    0xe: nsk # Hewlett-Packard Non-Stop Kernel\n    0xf: aros # Amiga Research OS\n    0x10: fenixos # The FenixOS highly scalable multi-core OS\n    0x11: cloudabi # Nuxi CloudABI\n    0x12: openvos # Stratus Technologies OpenVOS\n  # e_type\n  obj_type:\n    # ET_NONE\n    0: no_file_type\n    # ET_REL\n    1: relocatable\n    # ET_EXEC\n    2: executable\n    # ET_DYN\n    3: shared\n    # ET_CORE\n    4: core\n  # https://www.sco.com/developers/gabi/latest/ch4.eheader.html\n  # https://sourceware.org/git/?p=glibc.git;a=blob;f=elf/elf.h;hb=0f62fe0532\n  # https://github.com/NationalSecurityAgency/ghidra/blob/f5615aa240/Ghidra/Features/Base/src/main/java/ghidra/app/util/bin/format/elf/ElfConstants.java#L158-L510\n  # https://github.com/llvm/llvm-project/blob/f6928cf45516/llvm/include/llvm/BinaryFormat/ELF.h#L130\n  machine:\n    0:\n      id: no_machine\n      -orig-id: EM_NONE\n      doc: No machine\n    1:\n      id: m32\n      doc: AT&T WE 32100\n    2:\n      id: sparc\n      doc: Sun SPARC\n    3:\n      id: x86\n      -orig-id: EM_386\n      doc: Intel 80386\n    4:\n      id: m68k\n      -orig-id: EM_68K\n      doc: Motorola m68k family\n    5:\n      id: m88k\n      -orig-id: EM_88K\n      doc: Motorola m88k family\n    6:\n      id: iamcu\n      doc: |\n        Intel MCU\n\n        was assigned to `EM_486` (for Intel i486), but that value was deprecated\n        and replaced with this one\n      doc-ref:\n        - https://sourceware.org/bugzilla/show_bug.cgi?id=18404\n        - https://gcc.gnu.org/legacy-ml/gcc/2015-05/msg00090.html\n        - https://github.com/gcc-mirror/gcc/blob/240f07805d/libgo/go/debug/elf/elf.go#L389\n    7:\n      id: i860\n      -orig-id: EM_860\n      doc: Intel 80860\n    8:\n      id: mips\n      doc: MIPS R3000 big-endian\n    9:\n      id: s370\n      doc: IBM System/370\n    10:\n      id: mips_rs3_le\n      doc: MIPS R3000 little-endian\n    15:\n      id: parisc\n      doc: Hewlett-Packard PA-RISC\n    17:\n      id: vpp500\n      doc: Fujitsu VPP500\n    18:\n      id: sparc32plus\n      doc: Sun's \"v8plus\"\n    19:\n      id: i960\n      -orig-id: EM_960\n      doc: Intel 80960\n    20:\n      id: powerpc\n      -orig-id: EM_PPC\n      doc: PowerPC\n    21:\n      id: powerpc64\n      -orig-id: EM_PPC64\n      doc: PowerPC 64-bit\n    22:\n      id: s390\n      doc: IBM System/390\n    23:\n      id: spu\n      doc: IBM SPU/SPC\n    36:\n      id: v800\n      doc: NEC V800 series\n    37:\n      id: fr20\n      doc: Fujitsu FR20\n    38:\n      id: rh32\n      doc: TRW RH-32\n    39:\n      id: rce\n      doc: Motorola RCE\n    40:\n      id: arm\n      doc: ARM\n    41:\n      id: old_alpha\n      -orig-id: EM_FAKE_ALPHA\n      doc: DEC Alpha\n    42:\n      id: superh\n      -orig-id: EM_SH\n      doc: Hitachi SH\n    43:\n      id: sparc_v9\n      -orig-id: EM_SPARCV9\n      doc: SPARC v9 64-bit\n    44:\n      id: tricore\n      doc: Siemens TriCore\n    45:\n      id: arc\n      doc: Argonaut RISC Core\n    46:\n      id: h8_300\n      doc: Hitachi H8/300\n    47:\n      id: h8_300h\n      doc: Hitachi H8/300H\n    48:\n      id: h8s\n      doc: Hitachi H8S\n    49:\n      id: h8_500\n      doc: Hitachi H8/500\n    50:\n      id: ia_64\n      doc: Intel IA-64 processor architecture\n    51:\n      id: mips_x\n      doc: Stanford MIPS-X\n    52:\n      id: coldfire\n      doc: Motorola ColdFire\n    53:\n      id: m68hc12\n      -orig-id: EM_68HC12\n      doc: Motorola M68HC12\n    54:\n      id: mma\n      doc: Fujitsu MMA Multimedia Accelerator\n    55:\n      id: pcp\n      doc: Siemens PCP\n    56:\n      id: ncpu\n      doc: Sony nCPU embedded RISC processor\n    57:\n      id: ndr1\n      doc: Denso NDR1 microprocessor\n    58:\n      id: starcore\n      doc: Motorola Star*Core processor\n    59:\n      id: me16\n      doc: Toyota ME16 processor\n    60:\n      id: st100\n      doc: STMicroelectronics ST100 processor\n    61:\n      id: tinyj\n      doc: Advanced Logic Corp. TinyJ embedded processor family\n    62:\n      id: x86_64\n      doc: AMD x86-64 architecture\n    63:\n      id: pdsp\n      doc: Sony DSP Processor\n    64:\n      id: pdp10\n      doc: Digital Equipment Corp. PDP-10\n    65:\n      id: pdp11\n      doc: Digital Equipment Corp. PDP-11\n    66:\n      id: fx66\n      doc: Siemens FX66 microcontroller\n    67:\n      id: st9plus\n      doc: STMicroelectronics ST9+ 8/16 bit microcontroller\n    68:\n      id: st7\n      doc: STMicroelectronics ST7 8-bit microcontroller\n    69:\n      id: mc68hc16\n      -orig-id: EM_68HC16\n      doc: Motorola MC68HC16 microcontroller\n    70:\n      id: mc68hc11\n      -orig-id: EM_68HC11\n      doc: Motorola MC68HC11 microcontroller\n    71:\n      id: mc68hc08\n      -orig-id: EM_68HC08\n      doc: Motorola MC68HC08 microcontroller\n    72:\n      id: mc68hc05\n      -orig-id: EM_68HC05\n      doc: Motorola MC68HC05 microcontroller\n    73:\n      id: svx\n      doc: Silicon Graphics SVx\n    74:\n      id: st19\n      doc: STMicroelectronics ST19 8-bit microcontroller\n    75:\n      id: vax\n      doc: Digital VAX\n    76:\n      id: cris\n      doc: Axis Communications 32-bit embedded processor\n    77:\n      id: javelin\n      doc: Infineon Technologies 32-bit embedded processor\n    78:\n      id: firepath\n      doc: Element 14 64-bit DSP Processor\n    79:\n      id: zsp\n      doc: LSI Logic 16-bit DSP Processor\n    80:\n      id: mmix\n      doc: Donald Knuth's educational 64-bit processor\n    81:\n      id: huany\n      doc: Harvard University machine-independent object files\n    82:\n      id: prism\n      doc: SiTera Prism\n    83:\n      id: avr\n      doc: Atmel AVR 8-bit microcontroller\n    84:\n      id: fr30\n      doc: Fujitsu FR30\n    85:\n      id: d10v\n      doc: Mitsubishi D10V\n    86:\n      id: d30v\n      doc: Mitsubishi D30V\n    87:\n      id: v850\n      doc: NEC v850\n    88:\n      id: m32r\n      doc: Mitsubishi M32R\n    89:\n      id: mn10300\n      doc: Matsushita MN10300\n    90:\n      id: mn10200\n      doc: Matsushita MN10200\n    91:\n      id: picojava\n      -orig-id: EM_PJ\n      doc: picoJava\n    92:\n      id: openrisc\n      doc: OpenRISC 32-bit embedded processor\n    93:\n      id: arc_compact\n      doc: 'ARC International ARCompact processor (old spelling/synonym: EM_ARC_A5)'\n    94:\n      id: xtensa\n      doc: Tensilica Xtensa Architecture\n    95:\n      id: videocore\n      doc: Alphamosaic VideoCore processor\n    96:\n      id: tmm_gpp\n      doc: Thompson Multimedia General Purpose Processor\n    97:\n      id: ns32k\n      doc: National Semiconductor 32000 series\n    98:\n      id: tpc\n      doc: Tenor Network TPC processor\n    99:\n      id: snp1k\n      doc: Trebia SNP 1000 processor\n    100:\n      id: st200\n      doc: STMicroelectronics ST200\n    101:\n      id: ip2k\n      doc: Ubicom IP2xxx microcontroller family\n    102:\n      id: max\n      doc: MAX processor\n    103:\n      id: compact_risc\n      -orig-id: EM_CR\n      doc: National Semiconductor CompactRISC microprocessor\n    104:\n      id: f2mc16\n      doc: Fujitsu F2MC16\n    105:\n      id: msp430\n      doc: Texas Instruments embedded microcontroller MSP430\n    106:\n      id: blackfin\n      doc: Analog Devices Blackfin (DSP) processor\n    107:\n      id: se_c33\n      doc: Seiko Epson S1C33 family\n    108:\n      id: sep\n      doc: Sharp embedded microprocessor\n    109:\n      id: arca\n      doc: Arca RISC microprocessor\n    110:\n      id: unicore\n      doc: microprocessor series from PKU-Unity Ltd. and MPRC of Peking University\n    111:\n      id: excess\n      doc: 'eXcess: 16/32/64-bit configurable embedded CPU'\n    112:\n      id: dxp\n      doc: Icera Semiconductor Inc. Deep Execution Processor\n    113:\n      id: altera_nios2\n      doc: Altera Nios II soft-core processor\n    114:\n      id: crx\n      doc: National Semiconductor CompactRISC CRX microprocessor\n    115:\n      id: xgate\n      doc: Motorola XGATE embedded processor\n    116:\n      id: c166\n      doc: Infineon C16x/XC16x processor\n    117:\n      id: m16c\n      doc: Renesas M16C series microprocessors\n    118:\n      id: dspic30f\n      doc: Microchip Technology dsPIC30F Digital Signal Controller\n    119:\n      id: freescale_ce\n      -orig-id: EM_CE\n      doc: Freescale Communication Engine RISC core\n    120:\n      id: m32c\n      doc: Renesas M32C series microprocessors\n    131:\n      id: tsk3000\n      doc: Altium TSK3000 core\n    132:\n      id: rs08\n      doc: Freescale RS08 embedded processor\n    133:\n      id: sharc\n      doc: Analog Devices SHARC family of 32-bit DSP processors\n    134:\n      id: ecog2\n      doc: Cyan Technology eCOG2 microprocessor\n    135:\n      id: score7\n      doc: Sunplus S+core7 RISC processor\n    136:\n      id: dsp24\n      doc: New Japan Radio (NJR) 24-bit DSP Processor\n    137:\n      id: videocore3\n      doc: Broadcom VideoCore III processor\n    138:\n      id: latticemico32\n      doc: RISC processor for Lattice FPGA architecture\n    139:\n      id: se_c17\n      doc: Seiko Epson C17 family\n    140:\n      id: ti_c6000\n      doc: Texas Instruments TMS320C6000 DSP family\n    141:\n      id: ti_c2000\n      doc: Texas Instruments TMS320C2000 DSP family\n    142:\n      id: ti_c5500\n      doc: Texas Instruments TMS320C55x DSP family\n    143:\n      id: ti_arp32\n      doc: Texas Instruments Application Specific RISC Processor, 32bit fetch\n    144:\n      id: ti_pru\n      doc: Texas Instruments Programmable Realtime Unit\n    160:\n      id: mmdsp_plus\n      doc: STMicroelectronics 64bit VLIW Data Signal Processor\n    161:\n      id: cypress_m8c\n      doc: Cypress M8C microprocessor\n    162:\n      id: r32c\n      doc: Renesas R32C series microprocessors\n    163:\n      id: trimedia\n      doc: NXP Semiconductors TriMedia architecture family\n    164:\n      id: qdsp6\n      doc: Qualcomm Hexagon processor\n    165:\n      id: i8051\n      -orig-id: EM_8051\n      doc: Intel 8051 and variants\n    166:\n      id: stxp7x\n      doc: STMicroelectronics STxP7x family of configurable and extensible RISC processors\n    167:\n      id: nds32\n      doc: Andes Technology compact code size embedded RISC processor family\n    168:\n      id: ecog1x\n      doc: Cyan Technology eCOG1X family\n    169:\n      id: maxq30\n      doc: Dallas Semiconductor MAXQ30 Core Micro-controllers\n    170:\n      id: ximo16\n      doc: New Japan Radio (NJR) 16-bit DSP Processor\n    171:\n      id: manik\n      doc: M2000 Reconfigurable RISC Microprocessor\n    172:\n      id: craynv2\n      doc: Cray Inc. NV2 vector architecture\n    173:\n      id: rx\n      doc: Renesas RX family\n    174:\n      id: metag\n      doc: Imagination Technologies META processor architecture\n    175:\n      id: mcst_elbrus\n      doc: MCST Elbrus general purpose hardware architecture\n    176:\n      id: ecog16\n      doc: Cyan Technology eCOG16 family\n    177:\n      id: cr16\n      doc: National Semiconductor CompactRISC CR16 16-bit microprocessor\n    178:\n      id: etpu\n      doc: Freescale Extended Time Processing Unit\n    179:\n      id: sle9x\n      doc: Infineon Technologies SLE9X core\n    180:\n      id: l10m\n      doc: Intel L10M\n    181:\n      id: k10m\n      doc: Intel K10M\n    183:\n      id: aarch64\n      doc: ARM AArch64\n    185:\n      id: avr32\n      doc: Atmel Corporation 32-bit microprocessor family\n    186:\n      id: stm8\n      doc: STMicroeletronics STM8 8-bit microcontroller\n    187:\n      id: tile64\n      doc: Tilera TILE64 multicore architecture family\n    188:\n      id: tilepro\n      doc: Tilera TILEPro multicore architecture family\n    189:\n      id: microblaze\n      doc: Xilinx MicroBlaze 32-bit RISC soft processor core\n    190:\n      id: cuda\n      doc: NVIDIA CUDA architecture\n    191:\n      id: tilegx\n      doc: Tilera TILE-Gx multicore architecture family\n    192:\n      id: cloudshield\n      doc: CloudShield architecture family\n    193:\n      id: corea_1st\n      doc: KIPO-KAIST Core-A 1st generation processor family\n    194:\n      id: corea_2nd\n      doc: KIPO-KAIST Core-A 2nd generation processor family\n    195:\n      id: arcv2\n      doc: Synopsys ARCv2 ISA\n    196:\n      id: open8\n      doc: Open8 8-bit RISC soft processor core\n    197:\n      id: rl78\n      doc: Renesas RL78 family\n    198:\n      id: videocore5\n      doc: Broadcom VideoCore V processor\n    199:\n      id: renesas_78kor\n      -orig-id: EM_78KOR\n      doc: Renesas 78KOR family\n    200:\n      id: freescale_56800ex\n      -orig-id: EM_56800EX\n      doc: Freescale 56800EX Digital Signal Controller (DSC)\n    201:\n      id: ba1\n      doc: Beyond BA1 CPU architecture\n    202:\n      id: ba2\n      doc: Beyond BA2 CPU architecture\n    203:\n      id: xcore\n      doc: XMOS xCORE processor family\n    204:\n      id: mchp_pic\n      doc: Microchip 8-bit PIC(r) family\n    205:\n      id: intelgt\n      doc: Intel Graphics Technology\n      doc-ref: https://sourceware.org/git/?p=glibc.git;a=blob;f=elf/elf.h;hb=0f62fe0532#l339\n    206:\n      id: intel206\n      doc: Reserved by Intel\n    207:\n      id: intel207\n      doc: Reserved by Intel\n    208:\n      id: intel208\n      doc: Reserved by Intel\n    209:\n      id: intel209\n      doc: Reserved by Intel\n    210:\n      id: km32\n      doc: KM211 KM32 32-bit processor\n    211:\n      id: kmx32\n      doc: KM211 KMX32 32-bit processor\n    212:\n      id: kmx16\n      -orig-id: EM_EMX16\n      doc: KM211 KMX16 16-bit processor\n    213:\n      id: kmx8\n      -orig-id: EM_EMX8\n      doc: KM211 KMX8 8-bit processor\n    214:\n      id: kvarc\n      doc: KM211 KVARC processor\n    215:\n      id: cdp\n      doc: Paneve CDP architecture family\n    216:\n      id: coge\n      doc: Cognitive Smart Memory Processor\n    217:\n      id: cool\n      doc: Bluechip Systems CoolEngine\n    218:\n      id: norc\n      doc: Nanoradio Optimized RISC\n    219:\n      id: csr_kalimba\n      doc: CSR Kalimba architecture family\n    220:\n      id: z80\n      doc: Zilog Z80\n    221:\n      id: visium\n      doc: Controls and Data Services VISIUMcore\n    222:\n      id: ft32\n      doc: FTDI Chip FT32\n    223:\n      id: moxie\n      doc: Moxie processor\n    224:\n      id: amd_gpu\n      -orig-id: EM_AMDGPU\n      doc: AMD GPU architecture\n    243:\n      id: riscv\n      doc: RISC-V\n    244:\n      id: lanai\n      doc: Lanai 32-bit processor\n      doc-ref: https://github.com/llvm/llvm-project/blob/f6928cf45516/llvm/include/llvm/BinaryFormat/ELF.h#L319\n    245:\n      id: ceva\n      doc: CEVA Processor Architecture Family\n      doc-ref: https://groups.google.com/g/generic-abi/c/cmq1LFFpWqU\n    246:\n      id: ceva_x2\n      doc: CEVA X2 Processor Family\n      doc-ref: https://groups.google.com/g/generic-abi/c/cmq1LFFpWqU\n    247:\n      id: bpf\n      doc: Linux BPF - in-kernel virtual machine\n    248:\n      id: graphcore_ipu\n      doc: Graphcore Intelligent Processing Unit\n      doc-ref: https://groups.google.com/g/generic-abi/c/cmq1LFFpWqU\n    249:\n      id: img1\n      doc: Imagination Technologies\n      doc-ref: https://groups.google.com/g/generic-abi/c/cmq1LFFpWqU\n    250:\n      id: nfp\n      doc: Netronome Flow Processor (NFP)\n      doc-ref: https://groups.google.com/g/generic-abi/c/cmq1LFFpWqU\n    251:\n      id: ve\n      doc: NEC SX-Aurora Vector Engine (VE) processor\n      doc-ref: https://github.com/llvm/llvm-project/blob/f6928cf45516/llvm/include/llvm/BinaryFormat/ELF.h#L321\n    252:\n      id: csky\n      doc: C-SKY 32-bit processor\n    253:\n      id: arc_compact3_64\n      -orig-id: EM_ARC_COMPACT3_64\n      doc: Synopsys ARCv3 64-bit ISA/HS6x cores\n      doc-ref:\n        - https://gitlab.com/gnutools/binutils-gdb/-/blob/4ffb22ec40/include/elf/common.h#L350\n        - https://github.com/file/file/blob/9b2538d/magic/Magdir/elf#L301\n        - https://bugs.astron.com/view.php?id=251\n    254:\n      id: mcs6502\n      doc: MOS Technology MCS 6502 processor\n      doc-ref: https://gitlab.com/gnutools/binutils-gdb/-/blob/4ffb22ec40/include/elf/common.h#L351\n    255:\n      id: arc_compact3\n      -orig-id: EM_ARC_COMPACT3\n      doc: Synopsys ARCv3 32-bit\n      doc-ref:\n        - https://gitlab.com/gnutools/binutils-gdb/-/blob/4ffb22ec40/include/elf/common.h#L352\n        - https://github.com/file/file/blob/9b2538d/magic/Magdir/elf#L303\n        - https://bugs.astron.com/view.php?id=251\n    256:\n      id: kvx\n      doc: Kalray VLIW core of the MPPA processor family\n      doc-ref: https://gitlab.com/gnutools/binutils-gdb/-/blob/4ffb22ec40/include/elf/common.h#L353\n    257:\n      id: wdc65816\n      -orig-id: EM_65816\n      doc: WDC 65816/65C816\n      doc-ref: https://gitlab.com/gnutools/binutils-gdb/-/blob/4ffb22ec40/include/elf/common.h#L354\n    258:\n      id: loongarch\n      -orig-id: EM_LOONGARCH\n      doc: LoongArch\n      doc-ref: https://gitlab.com/gnutools/binutils-gdb/-/blob/4ffb22ec40/include/elf/common.h#L355\n    259:\n      id: kf32\n      -orig-id: EM_KF32\n      doc: ChipON KungFu32\n      doc-ref:\n        - https://gitlab.com/gnutools/binutils-gdb/-/blob/4ffb22ec40/include/elf/common.h#L356\n        - https://groups.google.com/g/generic-abi/c/n8tLQxj02YY\n    260:\n      id: u16_u8core\n      -orig-id: EM_U16_U8CORE\n      doc: LAPIS nX-U16/U8\n      doc-ref:\n        - https://gitlab.com/gnutools/binutils-gdb/-/blob/dfbcbf85ea/include/elf/common.h#L357\n    261:\n      id: tachyum\n      -orig-id: EM_TACHYUM\n      doc: Tachyum\n      doc-ref:\n        - https://gitlab.com/gnutools/binutils-gdb/-/blob/dfbcbf85ea/include/elf/common.h#L358\n    262:\n      id: nxp_56800ef\n      -orig-id: EM_56800EF\n      doc: NXP 56800EF Digital Signal Controller (DSC)\n      doc-ref:\n        - https://gitlab.com/gnutools/binutils-gdb/-/blob/dfbcbf85ea/include/elf/common.h#L359\n    # unofficial values\n    # https://gitlab.com/gnutools/binutils-gdb/-/blob/4ffb22ec40/include/elf/common.h#L358\n    0x1057:\n      id: avr_old\n      -orig-id: EM_AVR_OLD\n    0x1059:\n      id: msp430_old\n      -orig-id: EM_MSP430_OLD\n    0x1223:\n      id: adapteva_epiphany\n      -orig-id: EM_ADAPTEVA_EPIPHANY\n      doc: Adapteva's Epiphany architecture.\n    0x2530:\n      id: mt\n      -orig-id: EM_MT\n      doc: Morpho MT\n    0x3330:\n      id: cygnus_fr30\n      -orig-id: EM_CYGNUS_FR30\n    0x4157:\n      id: webassembly\n      -orig-id: EM_WEBASSEMBLY\n      doc: Unofficial value for Web Assembly binaries, as used by LLVM.\n    0x4688:\n      id: xc16x\n      -orig-id: EM_XC16X\n      doc: Infineon Technologies 16-bit microcontroller with C166-V2 core\n    0x4def:\n      id: s12z\n      -orig-id: EM_S12Z\n      doc: The Freescale toolchain generates elf files with this value.\n    0x5441:\n      id: cygnus_frv\n      -orig-id: EM_CYGNUS_FRV\n    0x5aa5:\n      id: dlx\n      -orig-id: EM_DLX\n      doc: openDLX\n    0x7650:\n      id: cygnus_d10v\n      -orig-id: EM_CYGNUS_D10V\n    0x7676:\n      id: cygnus_d30v\n      -orig-id: EM_CYGNUS_D30V\n    0x8217:\n      id: ip2k_old\n      -orig-id: EM_IP2K_OLD\n    0x9025:\n      id: cygnus_powerpc\n      -orig-id: EM_CYGNUS_POWERPC\n    0x9026:\n      id: alpha\n      -orig-id: EM_ALPHA\n    0x9041:\n      id: cygnus_m32r\n      -orig-id: EM_CYGNUS_M32R\n    0x9080:\n      id: cygnus_v850\n      -orig-id: EM_CYGNUS_V850\n    0xa390:\n      id: s390_old\n      -orig-id: EM_S390_OLD\n    0xabc7:\n      id: xtensa_old\n      -orig-id: EM_XTENSA_OLD\n    0xad45:\n      id: xstormy16\n      -orig-id: EM_XSTORMY16\n    0xbaab:\n      id: microblaze_old\n      -orig-id: EM_MICROBLAZE_OLD\n    0xbeef:\n      id: cygnus_mn10300\n      -orig-id: EM_CYGNUS_MN10300\n    0xdead:\n      id: cygnus_mn10200\n      -orig-id: EM_CYGNUS_MN10200\n    0xfeb0:\n      id: m32c_old\n      -orig-id: EM_M32C_OLD\n      doc: Renesas M32C and M16C\n    0xfeba:\n      id: iq2000\n      -orig-id: EM_IQ2000\n      doc: Vitesse IQ2000\n    0xfebb:\n      id: nios32\n      -orig-id: EM_NIOS32\n    0xf00d:\n      id: cygnus_mep\n      -orig-id: EM_CYGNUS_MEP\n      doc: Toshiba MeP\n    0xfeed:\n      id: moxie_old\n      -orig-id: EM_MOXIE_OLD\n      doc: Old, unofficial value for Moxie\n  ph_type:\n    0: null_type\n    1: load\n    2: dynamic\n    3: interp\n    4: note\n    5: shlib\n    6: phdr\n    7: tls\n    # 0x60000000: lo_os\n    0x65041580: pax_flags\n    # 0x6fffffff: hi_os\n    # 0x70000000: lo_proc\n    0x70000001: arm_exidx\n    # 0x7fffffff: hi_proc\n    0x6474e550: gnu_eh_frame\n    0x6474e551: gnu_stack\n    0x6474e552: gnu_relro\n    0x6474e553: gnu_property\n  # https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/section-headers.html#GUID-2CBE4879-2E76-426E-BB7F-CF0CB1D87C52__CHAPTER6-73445\n  # https://github.com/illumos/illumos-gate/blob/1d806c5f41/usr/src/boot/sys/sys/elf_common.h#L377-L462\n  sh_type:\n    0: null_type\n    1: progbits\n    2: symtab\n    3: strtab\n    4: rela\n    5: hash\n    6: dynamic\n    7: note\n    8: nobits\n    9: rel\n    10: shlib\n    11: dynsym\n    14: init_array\n    15: fini_array\n    16: preinit_array\n    17: group\n    18: symtab_shndx\n    19: relr\n    # 0x60000000: lo_os\n    # 0x6fffffef: lo_sunw\n    0x6fffffec:\n      id: sunw_symnsort\n      doc-ref: https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/section-headers.html#GUID-2CBE4879-2E76-426E-BB7F-CF0CB1D87C52__CHAPTER6-73445\n    0x6fffffed:\n      id: sunw_phname\n      doc-ref: https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/section-headers.html#GUID-2CBE4879-2E76-426E-BB7F-CF0CB1D87C52__CHAPTER6-73445\n    0x6fffffee:\n      id: sunw_ancillary\n      doc-ref: https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/section-headers.html#GUID-2CBE4879-2E76-426E-BB7F-CF0CB1D87C52__CHAPTER6-73445\n    0x6fffffef: sunw_capchain\n    0x6ffffff0: sunw_capinfo\n    0x6ffffff1: sunw_symsort\n    0x6ffffff2: sunw_tlssort\n    0x6ffffff3: sunw_ldynsym\n    0x6ffffff4: sunw_dof\n    0x6ffffff5: sunw_cap\n    # 0x6ffffff5: gnu_attributes\n    0x6ffffff6: sunw_signature\n    # 0x6ffffff6: gnu_hash\n    # 0x6ffffff7: gnu_liblist\n    0x6ffffff7: sunw_annotate\n    0x6ffffff8: sunw_debugstr\n    0x6ffffff9: sunw_debug\n    0x6ffffffa: sunw_move\n    0x6ffffffb: sunw_comdat\n    0x6ffffffc: sunw_syminfo\n    0x6ffffffd: sunw_verdef\n    # 0x6ffffffd: gnu_verdef\n    0x6ffffffe: sunw_verneed\n    # 0x6ffffffe: gnu_verneed\n    0x6fffffff: sunw_versym\n    # 0x6fffffff: gnu_versym\n    # 0x6fffffff: hi_sunw\n    # 0x6fffffff: hi_os\n    # 0x70000000: lo_proc\n    0x70000000: sparc_gotdata\n    0x70000001: amd64_unwind\n    # 0x70000001: arm_exidx\n    0x70000002: arm_preemptmap\n    0x70000003: arm_attributes\n    0x70000004:\n      id: arm_debugoverlay\n      doc-ref: https://github.com/illumos/illumos-gate/blob/1d806c5f41/usr/src/boot/sys/sys/elf_common.h#L425\n    0x70000005:\n      id: arm_overlaysection\n      doc-ref: https://github.com/illumos/illumos-gate/blob/1d806c5f41/usr/src/boot/sys/sys/elf_common.h#L426\n    # 0x7fffffff: hi_proc\n    # 0x80000000: lo_user\n    # 0xffffffff: hi_user\n  # https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/symbol-table-section.html#GUID-DBDD92CB-D58A-4CB5-861F-8868D8CB4552__CHAPTER7-27\n  symbol_visibility:\n    0: default\n    1: internal\n    2: hidden\n    3: protected\n    4: exported\n    5: singleton\n    6: eliminate\n  # https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/symbol-table-section.html#GUID-DBDD92CB-D58A-4CB5-861F-8868D8CB4552__CHAPTER6-TBL-21\n  symbol_binding:\n    0:\n      id: local\n      doc: not visible outside the object file containing their definition\n    1:\n      id: global_symbol\n      -affected-by: 90\n      doc: |\n        visible to all object files being combined\n\n        As of KSC 0.9, this enum key can't be called `global` because it would\n        cause a syntax error in Python (it is a keyword).\n    2:\n      id: weak\n      doc: like `symbol_binding::global_symbol`, but their definitions have lower precedence\n    # 10: lo_os\n    10:\n      id: os10\n      doc: reserved for operating system-specific semantics\n    11:\n      id: os11\n      doc: reserved for operating system-specific semantics\n    12:\n      id: os12\n      doc: reserved for operating system-specific semantics\n    # 12: hi_os\n    # 13: lo_proc\n    13:\n      id: proc13\n      doc: reserved for processor-specific semantics\n    14:\n      id: proc14\n      doc: reserved for processor-specific semantics\n    15:\n      id: proc15\n      doc: reserved for processor-specific semantics\n    # 15: hi_proc\n  # https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/symbol-table-section.html#GUID-DBDD92CB-D58A-4CB5-861F-8868D8CB4552__CHAPTER6-TBL-22\n  symbol_type:\n    0: no_type\n    1:\n      id: object\n      doc: associated with a data object, such as a variable, an array, and so on\n    2:\n      id: func\n      doc: associated with a function or other executable code\n    3:\n      id: section\n      doc: associated with a section\n    4:\n      id: file\n      doc: symbol's name gives the name of the source file associated with the object file\n    5:\n      id: common\n      doc: labels an uninitialized common block\n    6:\n      id: tls\n      doc: specifies a thread-local storage entity\n    8:\n      id: relc\n      doc: complex relocation expression\n      doc-ref: https://sourceware.org/git/?p=binutils-gdb.git;a=blob;f=include/elf/common.h;h=0d381f0d27;hb=HEAD#l1009\n    9:\n      id: srelc\n      doc: signed complex relocation expression\n      doc-ref: https://sourceware.org/git/?p=binutils-gdb.git;a=blob;f=include/elf/common.h;h=0d381f0d27;hb=HEAD#l1010\n    # 10: lo_os\n    10:\n      id: gnu_ifunc\n      doc: |\n        reserved for OS-specific semantics\n\n        `STT_GNU_IFUNC` is a GNU extension to ELF format that adds support for \"indirect functions\"\n    11:\n      id: os11\n      doc: reserved for OS-specific semantics\n    12:\n      id: os12\n      doc: reserved for OS-specific semantics\n    # 12: hi_os\n    # 13: lo_proc\n    13:\n      id: proc13\n      doc: reserved for processor-specific semantics\n    14:\n      id: proc14\n      doc: reserved for processor-specific semantics\n    15:\n      id: proc15\n      doc: reserved for processor-specific semantics\n    # 15: hi_proc\n  # https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/section-headers.html#GUID-2CBE4879-2E76-426E-BB7F-CF0CB1D87C52__CHAPTER6-TBL-16\n  # see also `_root.sh_idx_*` instances\n  section_header_idx_special:\n    0:\n      id: undefined\n      -orig-id: SHN_UNDEF\n    # 0xff00: lo_reserve\n    # 0xff00: lo_proc\n    0xff00: before\n    0xff01: after\n    0xff02: amd64_lcommon\n    # 0xff1f: hi_proc\n    # 0xff20: lo_os\n    # 0xff3f: lo_sunw\n    0xff3f: sunw_ignore\n    # 0xff3f: hi_sunw\n    # 0xff3f: hi_os\n    0xfff1: abs\n    0xfff2: common\n    0xffff: xindex\n    # 0xffff: hi_reserve\n  # https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/dynamic-section.html#GUID-4336A69A-D905-4FCE-A398-80375A9E6464__CHAPTER6-TBL-52\n  # https://sourceware.org/git/?p=glibc.git;a=blob;f=elf/elf.h;hb=0f62fe0532#l853\n  dynamic_array_tags:\n    0: \"null\"            # Marks end of dynamic section\n    1: needed            # Name of needed library\n    2: pltrelsz          # Size in bytes of PLT relocs\n    3: pltgot            # Processor defined value\n    4: hash              # Address of symbol hash table\n    5: strtab            # Address of string table\n    6: symtab            # Address of symbol table\n    7: rela              # Address of Rela relocs\n    8: relasz            # Total size of Rela relocs\n    9: relaent           # Size of one Rela reloc\n    10: strsz            # Size of string table\n    11: syment           # Size of one symbol table entry\n    12: init             # Address of init function\n    13: fini             # Address of termination function\n    14: soname           # Name of shared object\n    15: rpath            # Library search path (deprecated)\n    16: symbolic         # Start symbol search here\n    17: rel              # Address of Rel relocs\n    18: relsz            # Total size of Rel relocs\n    19: relent           # Size of one Rel reloc\n    20: pltrel           # Type of reloc in PLT\n    21: debug            # For debugging; unspecified\n    22: textrel          # Reloc might modify .text\n    23: jmprel           # Address of PLT relocs\n    24: bind_now         # Process relocations of object\n    25: init_array       # Array with addresses of init fct\n    26: fini_array       # Array with addresses of fini fct\n    27: init_arraysz     # Size in bytes of DT_INIT_ARRAY\n    28: fini_arraysz     # Size in bytes of DT_FINI_ARRAY\n    29: runpath          # Library search path\n    30: flags            # Flags for the object being loaded\n    32: preinit_array    # Array with addresses of preinit fct\n    33: preinit_arraysz  # Size in bytes of DT_PREINIT_ARRAY\n    34: symtab_shndx     # Address of SYMTAB_SHNDX section\n    35: relrsz\n    36: relr\n    37: relrent\n    # 38: encoding  # special value (marker):\n                    # Values `v >= ::encoding and v < ::lo_os` follow the rules\n                    # for the interpretation of the d_un union as follows:\n                    # even number == 'd_ptr', odd number == 'd_val' or none\n                    # <https://github.com/tianocore/edk2-archive/blob/072289f45c/ArmPlatformPkg/Library/ArmShellCmdRunAxf/elf_common.h#L336-L340>\n    # 0x6000000d: lo_os\n    0x6000000d: sunw_auxiliary\n    0x6000000e:\n      id: sunw_rtldinf\n      doc-ref:\n        - https://github.com/gcc-mirror/gcc/blob/240f07805d/libphobos/libdruntime/core/sys/solaris/sys/link.d#L76\n        - https://github.com/illumos/illumos-gate/blob/1d806c5f41/usr/src/uts/common/sys/link.h#L135\n    0x6000000f:\n      id: sunw_filter\n      doc: |\n        Note: <https://docs.oracle.com/en/operating-systems/solaris/oracle-solaris/11.4/linkers-libraries/dynamic-section.html#GUID-4336A69A-D905-4FCE-A398-80375A9E6464__CHAPTER6-TBL-52>\n        states that `DT_SUNW_FILTER` has the value `0x6000000e`, but this is\n        apparently only a human error - that would make the value collide with\n        the previous one (`DT_SUNW_RTLDINF`) and there is not even a single\n        source supporting this other than verbatim copies of the same table.\n      doc-ref:\n        - https://github.com/gcc-mirror/gcc/blob/240f07805d/libphobos/libdruntime/core/sys/solaris/sys/link.d#L77\n        - https://github.com/illumos/illumos-gate/blob/1d806c5f41/usr/src/uts/common/sys/link.h#L136\n    0x60000010: sunw_cap\n    0x60000011: sunw_symtab\n    0x60000012: sunw_symsz\n    # 0x60000013: sunw_encoding  # DT_* encoding rules apply again for values\n                                 # `v >= ::sunw_encoding and v <= ::hi_os` (see\n                                 # `::encoding` description)\n    0x60000013: sunw_sortent\n    0x60000014: sunw_symsort\n    0x60000015: sunw_symsortsz\n    0x60000016: sunw_tlssort\n    0x60000017: sunw_tlssortsz\n    0x60000018: sunw_capinfo\n    0x60000019: sunw_strpad\n    0x6000001a: sunw_capchain\n    0x6000001b: sunw_ldmach\n    0x6000001c: sunw_symtab_shndx\n    0x6000001d: sunw_capchainent\n    0x6000001e: sunw_deferred\n    0x6000001f: sunw_capchainsz\n    0x60000020: sunw_phname\n    0x60000021: sunw_parent\n    0x60000023: sunw_sx_aslr\n    0x60000025: sunw_relax\n    0x60000027: sunw_kmod\n    0x60000029: sunw_sx_nxheap\n    0x6000002b: sunw_sx_nxstack\n    0x6000002d: sunw_sx_adiheap\n    0x6000002f: sunw_sx_adistack\n    0x60000031: sunw_sx_ssbd\n    0x60000032: sunw_symnsort\n    0x60000033: sunw_symnsortsz\n    # 0x6ffff000: hi_os\n    # 0x6ffffd00: val_rng_lo  # Values `v >= ::val_rng_lo and v <= ::val_rng_hi`\n                              # use the 'd_val' field of the dynamic structure\n    0x6ffffdf4:\n      id: gnu_flags_1\n      doc-ref: https://sourceware.org/git/?p=binutils-gdb.git;a=blob;f=include/elf/common.h;h=0d381f0d27;hb=HEAD#l1091\n    0x6ffffdf5: gnu_prelinked   # Prelinking timestamp\n    0x6ffffdf6: gnu_conflictsz  # Size of conflict section\n    0x6ffffdf7: gnu_liblistsz   # Size of library list\n    0x6ffffdf8: checksum\n    0x6ffffdf9: pltpadsz\n    0x6ffffdfa: moveent\n    0x6ffffdfb: movesz\n    0x6ffffdfc: feature_1       # Feature selection (DTF_*).\n    0x6ffffdfd: posflag_1       # Flags for DT_* entries, effecting the following DT_* entry.\n    0x6ffffdfe: syminsz         # Size of syminfo table (in bytes)\n    0x6ffffdff: syminent        # Entry size of syminfo\n    # 0x6ffffdff: val_rng_hi\n    # 0x6ffffe00: addr_rng_lo  # Values `v >= ::addr_rng_lo and v <= ::addr_rng_hi`\n                               # use the 'd_ptr' field of the dynamic structure\n    0x6ffffef5: gnu_hash\n    0x6ffffef6: tlsdesc_plt\n    0x6ffffef7: tlsdesc_got\n    0x6ffffef8: gnu_conflict\n    0x6ffffef9: gnu_liblist\n    0x6ffffefa: config\n    0x6ffffefb: depaudit\n    0x6ffffefc: audit\n    0x6ffffefd: pltpad\n    0x6ffffefe: movetab\n    0x6ffffeff: syminfo\n    # 0x6ffffeff: addr_rng_hi\n    0x6ffffff0: versym\n    0x6ffffff9: relacount\n    0x6ffffffa: relcount\n    0x6ffffffb: flags_1\n    0x6ffffffc: verdef\n    0x6ffffffd: verdefnum\n    0x6ffffffe: verneed\n    0x6fffffff: verneednum\n    # 0x70000000: lo_proc\n    0x70000001:\n      id: sparc_register\n      doc-ref: https://github.com/illumos/illumos-gate/blob/1d806c5f41/usr/src/boot/sys/sys/elf_common.h#L634-L635\n    0x07000001:\n      id: deprecated_sparc_register\n      doc: |\n        DT_SPARC_REGISTER was originally assigned 0x7000001. It is processor\n        specific, and should have been in the range DT_LOPROC-DT_HIPROC\n        instead of here. When the error was fixed,\n        DT_DEPRECATED_SPARC_REGISTER was created to maintain backward\n        compatability.\n      doc-ref:\n        - https://github.com/illumos/illumos-gate/blob/1d806c5f41/usr/src/cmd/sgs/libconv/common/dynamic.c#L522-L528\n        - https://github.com/illumos/illumos-gate/blob/1d806c5f41/usr/src/boot/sys/sys/elf_common.h#L634-L635\n    0x7ffffffd: auxiliary\n    0x7ffffffe: used\n    0x7fffffff: filter\n    # 0x7fffffff: hi_proc\n"
  },
  {
    "id": "ksy_java_class",
    "name": "Java Class",
    "category": "Executable",
    "metadata": {
      "isGenerated": true,
      "fileExtensions": [
        "class"
      ],
      "description": "",
      "originalCategory": "executable",
      "filePath": "executable/java_class.ksy",
      "signature": {
        "offset": 0,
        "bytes": [
          202,
          254,
          186,
          190
        ]
      },
      "endian": "be"
    },
    "content": "meta:\n  id: java_class\n  file-extension: class\n  xref:\n    justsolve: Java\n    pronom: x-fmt/415\n    wikidata: Q2193155\n  license: CC0-1.0\n  endian: be\ndoc-ref:\n  - https://docs.oracle.com/javase/specs/jvms/se19/html/jvms-4.html\n  - https://docs.oracle.com/javase/specs/jls/se6/jls3.pdf\n  - https://github.com/openjdk/jdk/blob/jdk-21%2B14/src/jdk.hotspot.agent/share/classes/sun/jvm/hotspot/runtime/ClassConstants.java\n  - https://github.com/openjdk/jdk/blob/jdk-21%2B14/src/java.base/share/native/include/classfile_constants.h.template\n  - https://github.com/openjdk/jdk/blob/jdk-21%2B14/src/hotspot/share/classfile/classFileParser.cpp\nseq:\n  - id: magic\n    contents: [0xca, 0xfe, 0xba, 0xbe]\n  - id: version_minor\n    type: u2\n  - id: version_major\n    type: u2\n    valid:\n      # https://github.com/file/file/blob/905ca555/magic/Magdir/cafebabe#L11-L12\n      min: 43\n  - id: constant_pool_count\n    type: u2\n  - id: constant_pool\n    type: 'constant_pool_entry(_index != 0 ? constant_pool[_index - 1].is_two_entries : false)'\n    repeat: expr\n    repeat-expr: constant_pool_count - 1\n  - id: access_flags\n    type: u2\n  - id: this_class\n    type: u2\n  - id: super_class\n    type: u2\n  - id: interfaces_count\n    type: u2\n  - id: interfaces\n    type: u2\n    repeat: expr\n    repeat-expr: interfaces_count\n  - id: fields_count\n    type: u2\n  - id: fields\n    type: field_info\n    repeat: expr\n    repeat-expr: fields_count\n  - id: methods_count\n    type: u2\n  - id: methods\n    type: method_info\n    repeat: expr\n    repeat-expr: methods_count\n  - id: attributes_count\n    type: u2\n  - id: attributes\n    type: attribute_info\n    repeat: expr\n    repeat-expr: attributes_count\ntypes:\n  constant_pool_entry:\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4\n    params:\n      - id: is_prev_two_entries\n        type: bool\n    seq:\n      - id: tag\n        type: u1\n        enum: tag_enum\n        if: not is_prev_two_entries\n      - id: cp_info\n        type:\n          switch-on: tag\n          cases:\n            tag_enum::class_type: class_cp_info\n            tag_enum::field_ref: field_ref_cp_info\n            tag_enum::method_ref: method_ref_cp_info\n            tag_enum::interface_method_ref: interface_method_ref_cp_info\n            tag_enum::string: string_cp_info\n            tag_enum::integer: integer_cp_info\n            tag_enum::float: float_cp_info\n            tag_enum::long: long_cp_info\n            tag_enum::double: double_cp_info\n            tag_enum::name_and_type: name_and_type_cp_info\n            tag_enum::utf8: utf8_cp_info\n            tag_enum::method_handle: method_handle_cp_info\n            tag_enum::method_type: method_type_cp_info\n            tag_enum::invoke_dynamic: invoke_dynamic_cp_info\n            tag_enum::dynamic: dynamic_cp_info\n            tag_enum::module: module_package_cp_info\n            tag_enum::package: module_package_cp_info\n        if: not is_prev_two_entries\n    instances:\n      is_two_entries:\n        value: 'is_prev_two_entries ? false : tag == tag_enum::long or tag == tag_enum::double'\n    enums:\n      tag_enum:\n        1:\n          id: utf8\n          -orig-id: CONSTANT_Utf8\n        3:\n          id: integer\n          -orig-id: CONSTANT_Integer\n        4:\n          id: float\n          -orig-id: CONSTANT_Float\n        5:\n          id: long\n          -orig-id: CONSTANT_Long\n        6:\n          id: double\n          -orig-id: CONSTANT_Double\n        7:\n          id: class_type\n          -orig-id: CONSTANT_Class\n        8:\n          id: string\n          -orig-id: CONSTANT_String\n        9:\n          id: field_ref\n          -orig-id: CONSTANT_Fieldref\n        10:\n          id: method_ref\n          -orig-id: CONSTANT_Methodref\n        11:\n          id: interface_method_ref\n          -orig-id: CONSTANT_InterfaceMethodref\n        12:\n          id: name_and_type\n          -orig-id: CONSTANT_NameAndType\n        15:\n          id: method_handle\n          -orig-id: CONSTANT_MethodHandle\n        16:\n          id: method_type\n          -orig-id: CONSTANT_MethodType\n        17:\n          id: dynamic\n          -orig-id: CONSTANT_Dynamic\n        18:\n          id: invoke_dynamic\n          -orig-id: CONSTANT_InvokeDynamic\n        19:\n          id: module\n          -orig-id: CONSTANT_Module\n        20:\n          id: package\n          -orig-id: CONSTANT_Package\n\n  version_guard:\n    doc: |\n      `class` file format version 45.3 (appeared in the very first publicly\n      known release of Java SE AND JDK 1.0.2, released 23th January 1996) is so\n      ancient that it's taken for granted. Earlier formats seem to be\n      undocumented. Changes of `version_minor` don't change `class` format.\n      Earlier `version_major`s likely belong to Oak programming language, the\n      proprietary predecessor of Java.\n    doc-ref:\n      - \"James Gosling, Bill Joy and Guy Steele. The Java Language Specification. English. Ed. by Lisa Friendly. Addison-Wesley, Aug. 1996, p. 825. ISBN: 0-201-63451-1.\"\n      - \"Frank Yellin and Tim Lindholm. The Java Virtual Machine Specification. English. Ed. by Lisa Friendly. Addison-Wesley, Sept. 1996, p. 475. ISBN: 0-201-63452-X.\"\n    params:\n      - id: major\n        type: u2\n    seq:\n      - size: 0\n        valid:\n          expr: _root.version_major >= major\n\n  class_cp_info:\n    -orig-id: CONSTANT_Class_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.1\n    seq:\n      - id: name_index\n        type: u2\n    instances:\n      name_as_info:\n        value: _root.constant_pool[name_index - 1].cp_info.as<utf8_cp_info>\n      name_as_str:\n        value: name_as_info.value\n  field_ref_cp_info:\n    -orig-id: CONSTANT_Fieldref_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.2\n    seq:\n      - id: class_index\n        type: u2\n      - id: name_and_type_index\n        type: u2\n    instances:\n      class_as_info:\n        value: _root.constant_pool[class_index - 1].cp_info.as<class_cp_info>\n      name_and_type_as_info:\n        value: _root.constant_pool[name_and_type_index - 1].cp_info.as<name_and_type_cp_info>\n  method_ref_cp_info:\n    -orig-id: CONSTANT_Methodref_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.2\n    seq:\n      - id: class_index\n        type: u2\n      - id: name_and_type_index\n        type: u2\n    instances:\n      class_as_info:\n        value: _root.constant_pool[class_index - 1].cp_info.as<class_cp_info>\n      name_and_type_as_info:\n        value: _root.constant_pool[name_and_type_index - 1].cp_info.as<name_and_type_cp_info>\n  interface_method_ref_cp_info:\n    -orig-id: CONSTANT_InterfaceMethodref_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.2\n    seq:\n      - id: class_index\n        type: u2\n      - id: name_and_type_index\n        type: u2\n    instances:\n      class_as_info:\n        value: _root.constant_pool[class_index - 1].cp_info.as<class_cp_info>\n      name_and_type_as_info:\n        value: _root.constant_pool[name_and_type_index - 1].cp_info.as<name_and_type_cp_info>\n  string_cp_info:\n    -orig-id: CONSTANT_String_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.3\n    seq:\n      - id: string_index\n        type: u2\n  integer_cp_info:\n    -orig-id: CONSTANT_Integer_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.4\n    seq:\n      - id: value\n        type: u4\n  float_cp_info:\n    -orig-id: CONSTANT_Float_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.5\n    seq:\n      - id: value\n        type: f4\n  long_cp_info:\n    -orig-id: CONSTANT_Long_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.5\n    seq:\n      - id: value\n        type: u8\n  double_cp_info:\n    -orig-id: CONSTANT_Double_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.6\n    seq:\n      - id: value\n        type: f8\n  name_and_type_cp_info:\n    -orig-id: CONSTANT_NameAndType_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.6\n    seq:\n      - id: name_index\n        type: u2\n      - id: descriptor_index\n        type: u2\n    instances:\n      name_as_info:\n        value: _root.constant_pool[name_index - 1].cp_info.as<utf8_cp_info>\n      name_as_str:\n        value: name_as_info.value\n      descriptor_as_info:\n        value: _root.constant_pool[descriptor_index - 1].cp_info.as<utf8_cp_info>\n      descriptor_as_str:\n        value: descriptor_as_info.value\n  utf8_cp_info:\n    -orig-id: CONSTANT_Utf8_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.7\n    seq:\n      - id: str_len\n        type: u2\n      - id: value\n        type: str\n        size: str_len\n        encoding: UTF-8\n  method_handle_cp_info:\n    -orig-id: CONSTANT_MethodHandle_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.8\n    seq:\n      - type: version_guard(51)\n      - id: reference_kind\n        type: u1\n        enum: reference_kind_enum\n      - id: reference_index\n        type: u2\n    enums:\n      reference_kind_enum:\n        1: get_field\n        2: get_static\n        3: put_field\n        4: put_static\n        5: invoke_virtual\n        6: invoke_static\n        7: invoke_special\n        8: new_invoke_special\n        9: invoke_interface\n  method_type_cp_info:\n    -orig-id: CONSTANT_MethodType_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.9\n    seq:\n      - type: version_guard(51)\n      - id: descriptor_index\n        type: u2\n  dynamic_cp_info:\n    -orig-id: CONSTANT_Dynamic_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se19/html/jvms-4.html#jvms-4.4.10\n    seq:\n      - type: version_guard(55)\n      - id: bootstrap_method_attr_index\n        type: u2\n      - id: name_and_type_index\n        type: u2\n  invoke_dynamic_cp_info:\n    -orig-id: CONSTANT_InvokeDynamic_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.10\n    seq:\n      - type: version_guard(51)\n      - id: bootstrap_method_attr_index\n        type: u2\n      - id: name_and_type_index\n        type: u2\n  module_package_cp_info:\n    -orig-id:\n      - CONSTANT_Module_info\n      - CONSTANT_Package_info\n    doc: |\n      Project Jigsaw modules introduced in Java 9\n    doc-ref:\n      - https://docs.oracle.com/javase/specs/jvms/se19/html/jvms-3.html#jvms-3.16\n      - https://docs.oracle.com/javase/specs/jvms/se19/html/jvms-4.html#jvms-4.4.11\n      - https://docs.oracle.com/javase/specs/jvms/se19/html/jvms-4.html#jvms-4.4.12\n    seq:\n      - type: version_guard(53)\n      - id: name_index\n        type: u2\n    instances:\n      name_as_info:\n        value: _root.constant_pool[name_index - 1].cp_info.as<utf8_cp_info>\n      name_as_str:\n        value: name_as_info.value\n  field_info:\n    -orig-id: field_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.5\n    seq:\n      - id: access_flags\n        type: u2\n      - id: name_index\n        type: u2\n      - id: descriptor_index\n        type: u2\n      - id: attributes_count\n        type: u2\n      - id: attributes\n        type: attribute_info\n        repeat: expr\n        repeat-expr: attributes_count\n    instances:\n      name_as_str:\n        value: _root.constant_pool[name_index - 1].cp_info.as<utf8_cp_info>.value\n  attribute_info:\n    -orig-id: attribute_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.7\n    seq:\n      - id: name_index\n        type: u2\n      - id: attribute_length\n        type: u4\n      - id: info\n        size: attribute_length\n        type:\n          switch-on: name_as_str\n          cases:\n            '\"Code\"': attr_body_code # 4.7.3\n            '\"Exceptions\"': attr_body_exceptions # 4.7.5\n            '\"SourceFile\"': attr_body_source_file # 4.7.10\n            '\"LineNumberTable\"': attr_body_line_number_table # 4.7.12\n    instances:\n      name_as_str:\n        value: _root.constant_pool[name_index - 1].cp_info.as<utf8_cp_info>.value\n    types:\n      attr_body_code:\n        doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.7.3\n        seq:\n          - id: max_stack\n            type: u2\n          - id: max_locals\n            type: u2\n          - id: code_length\n            type: u4\n          - id: code\n            size: code_length\n          - id: exception_table_length\n            type: u2\n          - id: exception_table\n            type: exception_entry\n            repeat: expr\n            repeat-expr: exception_table_length\n          - id: attributes_count\n            type: u2\n          - id: attributes\n            type: attribute_info\n            repeat: expr\n            repeat-expr: attributes_count\n        types:\n          exception_entry:\n            doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.7.3\n            seq:\n              - id: start_pc\n                type: u2\n                doc: |\n                  Start of a code region where exception handler is being\n                  active, index in code array (inclusive)\n              - id: end_pc\n                type: u2\n                doc: |\n                  End of a code region where exception handler is being\n                  active, index in code array (exclusive)\n              - id: handler_pc\n                type: u2\n                doc: Start of exception handler code, index in code array\n              - id: catch_type\n                type: u2\n                doc: |\n                  Exception class that this handler catches, index in constant\n                  pool, or 0 (catch all exceptions handler, used to implement\n                  `finally`).\n            instances:\n              catch_exception:\n                value: _root.constant_pool[catch_type - 1]\n                if: catch_type != 0\n      attr_body_exceptions:\n        doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.7.5\n        seq:\n          - id: number_of_exceptions\n            type: u2\n          - id: exceptions\n            type: exception_table_entry\n            repeat: expr\n            repeat-expr: number_of_exceptions\n        types:\n          exception_table_entry:\n            seq:\n              - id: index\n                type: u2\n            instances:\n              as_info:\n                value: _root.constant_pool[index - 1].cp_info.as<class_cp_info>\n              name_as_str:\n                value: as_info.name_as_str\n      attr_body_source_file:\n        doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.7.10\n        seq:\n          - id: sourcefile_index\n            type: u2\n        instances:\n          sourcefile_as_str:\n            value: _root.constant_pool[sourcefile_index - 1].cp_info.as<utf8_cp_info>.value\n      attr_body_line_number_table:\n        doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.7.12\n        seq:\n          - id: line_number_table_length\n            type: u2\n          - id: line_number_table\n            type: line_number_table_entry\n            repeat: expr\n            repeat-expr: line_number_table_length\n        types:\n          line_number_table_entry:\n            seq:\n              - id: start_pc\n                type: u2\n              - id: line_number\n                type: u2\n  method_info:\n    -orig-id: method_info\n    doc-ref: https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.6\n    seq:\n      - id: access_flags\n        type: u2\n      - id: name_index\n        type: u2\n      - id: descriptor_index\n        type: u2\n      - id: attributes_count\n        type: u2\n      - id: attributes\n        type: attribute_info\n        repeat: expr\n        repeat-expr: attributes_count\n    instances:\n      name_as_str:\n        value: _root.constant_pool[name_index - 1].cp_info.as<utf8_cp_info>.value\n"
  },
  {
    "id": "ksy_mach_o",
    "name": "Mach O",
    "category": "Executable",
    "metadata": {
      "isGenerated": true,
      "fileExtensions": [],
      "description": "",
      "originalCategory": "executable",
      "filePath": "executable/mach_o.ksy",
      "endian": "le"
    },
    "content": "meta:\n  id: mach_o\n  xref:\n    justsolve: Mach-O\n    pronom:\n      - fmt/692 # Mach-O 32bit\n      - fmt/693 # Mach-O 64bit\n    wikidata: Q2627217\n  license: MIT\n  ks-version: 0.9\n  imports:\n    - /serialization/asn1/asn1_der\n  endian: le\ndoc-ref:\n  - https://www.stonedcoder.org/~kd/lib/MachORuntime.pdf\n  - https://opensource.apple.com/source/python_modules/python_modules-43/Modules/macholib-1.5.1/macholib-1.5.1.tar.gz\n  - https://github.com/comex/cs/blob/07a88f9/macho_cs.py\n  - https://opensource.apple.com/source/Security/Security-55471/libsecurity_codesigning/requirements.grammar.auto.html\n  - https://github.com/apple/darwin-xnu/blob/xnu-2782.40.9/bsd/sys/codesign.h\n  - https://opensource.apple.com/source/dyld/dyld-852/src/ImageLoaderMachO.cpp.auto.html\n  - https://opensource.apple.com/source/dyld/dyld-852/src/ImageLoaderMachOCompressed.cpp.auto.html\nseq:\n  - id: magic\n    type: u4be\n    enum: magic_type\n  - id: header\n    type: mach_header\n  - id: load_commands\n    type: load_command\n    repeat: expr\n    repeat-expr: header.ncmds\nenums:\n  magic_type:\n    # Note that for multiarch (a.k.a. fat) Mach-O files, which are the primary\n    # kind you find on macOS today, you should instead use mach_o_fat.ksy, which\n    # parses the fat header and embeds mach_o.ksy to parse each arch.\n    0xFEEDFACE: macho_be_x86 # MH_MAGIC:    mach-o, big-endian,    x86\n    0xCEFAEDFE: macho_le_x86 # MH_CIGAM:    mach-o, little-endian, x86\n    0xFEEDFACF: macho_be_x64 # MH_MAGIC_64: mach-o, big-endian,    x64\n    0xCFFAEDFE: macho_le_x64 # MH_CIGAM_64: mach-o, little-endian, x64\n  cpu_type:\n    0xffffffff: any\n    1:          vax\n    2:          romp\n    4:          ns32032\n    5:          ns32332\n    7:          i386\n    8:          mips\n    9:          ns32532\n    11:         hppa\n    12:         arm\n    13:         mc88000\n    14:         sparc\n    15:         i860\n    16:         i860_little\n    17:         rs6000\n    18:         powerpc\n    0x1000000:  abi64     # flag\n    0x1000007:  x86_64    # abi64 | i386\n    0x1000012:  powerpc64 # abi64 | powerpc\n    0x100000c:  arm64     # abi64 | arm\n  file_type:\n    # https://opensource.apple.com/source/xnu/xnu-1456.1.26/EXTERNAL_HEADERS/mach-o/loader.h\n    0x1: object      # relocatable object file\n    0x2: execute     # demand paged executable file\n    0x3: fvmlib      # fixed VM shared library file\n    0x4: core        # core file\n    0x5: preload     # preloaded executable file\n    0x6: dylib       # dynamically bound shared library\n    0x7: dylinker    # dynamic link editor\n    0x8: bundle      # dynamically bound bundle file\n    0x9: dylib_stub  # shared library stub for static linking only, no section contents\n    0xa: dsym        # companion file with only debug sections\n    0xb: kext_bundle # x86_64 kexts\n  load_command_type:\n    # https://opensource.apple.com/source/xnu/xnu-1456.1.26/EXTERNAL_HEADERS/mach-o/loader.h\n    0x80000000: req_dyld\n    0x1       : segment        # segment of this file to be mapped\n    0x2       : symtab         # link-edit stab symbol table info\n    0x3       : symseg         # link-edit gdb symbol table info (obsolete)\n    0x4       : thread         # thread\n    0x5       : unix_thread    # unix thread (includes a stack)\n    0x6       : load_fvm_lib   # load a specified fixed VM shared library\n    0x7       : id_fvm_lib     # fixed VM shared library identification\n    0x8       : ident          # object identification info (obsolete)\n    0x9       : fvm_file       # fixed VM file inclusion (internal use)\n    0xa       : prepage        # prepage command (internal use)\n    0xb       : dysymtab       # dynamic link-edit symbol table info\n    0xc       : load_dylib     # load a dynamically linked shared library\n    0xd       : id_dylib       # dynamically linked shared lib ident\n    0xe       : load_dylinker  # load a dynamic linker\n    0xf       : id_dylinker    # dynamic linker identification\n    0x10      : prebound_dylib # modules prebound for a dynamically\n    # linked shared library\n    0x11      : routines           # image routines\n    0x12      : sub_framework      # sub framework\n    0x13      : sub_umbrella       # sub umbrella\n    0x14      : sub_client         # sub client\n    0x15      : sub_library        # sub library\n    0x16      : twolevel_hints     # two-level namespace lookup hints\n    0x17      : prebind_cksum      # prebind checksum\n    0x80000018: load_weak_dylib    # load a dynamically linked shared library that is allowed to be missing (all symbols are weak imported)\n    0x19      : segment_64         # 64-bit segment of this file to be mapped\n    0x1a      : routines_64        # 64-bit image routines\n    0x1b      : uuid               # the uuid\n    0x8000001c: rpath              # runpath additions\n    0x1d      : code_signature     # local of code signature\n    0x1e      : segment_split_info # local of info to split segments\n    0x8000001f: reexport_dylib     # load and re-export dylib\n    0x20      : lazy_load_dylib    # delay load of dylib until first use\n    0x21      : encryption_info    # encrypted segment information\n    0x22      : dyld_info          # compressed dyld information\n    0x80000022: dyld_info_only     # compressed dyld information only\n    0x80000023: load_upward_dylib\n    0x24      : version_min_macosx\n    0x25      : version_min_iphoneos\n    0x26      : function_starts\n    0x27      : dyld_environment\n    0x80000028: main\n    0x29      : data_in_code\n    0x2A      : source_version\n    0x2B      : dylib_code_sign_drs\n    0x2C      : encryption_info_64\n    0x2D      : linker_option\n    0x2E      : linker_optimization_hint\n    0x2F      : version_min_tvos\n    0x30      : version_min_watchos\n    0x32      : build_version # LC_BUILD_VERSION\ntypes:\n  macho_flags:\n    -webide-representation: \"{this:flags}\"\n    params:\n      - id: value\n        type: u4\n    instances:\n      no_undefs:\n        value: value & 0x1 != 0\n        doc: \"the object file has no undefined references\"\n      incr_link:\n        value: value & 0x2 != 0\n        doc: \"the object file is the output of an incremental link against a base file and can't be link edited again\"\n      dyld_link:\n        value: value & 0x4 != 0\n        doc: \"the object file is input for the dynamic linker and can't be staticly link edited again\"\n      bind_at_load:\n        value: value & 0x8 != 0\n        doc: \"the object file's undefined references are bound by the dynamic linker when loaded.\"\n      prebound:\n        value: value & 0x10 != 0\n        doc: \"the file has its dynamic undefined references prebound.\"\n      split_segs:\n        value: value & 0x20 != 0\n        doc: \"the file has its read-only and read-write segments split\"\n      lazy_init:\n        value: value & 0x40 != 0\n        doc: \"the shared library init routine is to be run lazily via catching memory faults to its writeable segments (obsolete)\"\n      two_level:\n        value: value & 0x80 != 0\n        doc: \"the image is using two-level name space bindings\"\n      force_flat:\n        value: value & 0x100 != 0\n        doc: \"the executable is forcing all images to use flat name space bindings\"\n      no_multi_defs:\n        value: value & 0x200 != 0\n        doc: \"this umbrella guarantees no multiple defintions of symbols in its sub-images so the two-level namespace hints can always be used.\"\n      no_fix_prebinding:\n        value: value & 0x400 != 0\n        doc: \"do not have dyld notify the prebinding agent about this executable\"\n      prebindable:\n        value: value & 0x800 != 0\n        doc: \"the binary is not prebound but can have its prebinding redone. only used when MH_PREBOUND is not set.\"\n      all_mods_bound:\n        value: value & 0x1000 != 0\n        doc: \"indicates that this binary binds to all two-level namespace modules of its dependent libraries. only used when MH_PREBINDABLE and MH_TWOLEVEL are both set.\"\n      subsections_via_symbols:\n        value: value & 0x2000 != 0\n        doc: \"safe to divide up the sections into sub-sections via symbols for dead code stripping\"\n      canonical:\n        value: value & 0x4000 != 0\n        doc: \"the binary has been canonicalized via the unprebind operation\"\n      weak_defines:\n        value: value & 0x8000 != 0\n        doc: \"the final linked image contains external weak symbols\"\n      binds_to_weak:\n        value: value & 0x10000 != 0\n        doc: \"the final linked image uses weak symbols\"\n      allow_stack_execution:\n        value: value & 0x20000 != 0\n        doc: \"When this bit is set, all stacks in the task will be given stack execution privilege.  Only used in MH_EXECUTE filetypes.\"\n      root_safe:\n        value: value & 0x40000 != 0\n        doc: \"When this bit is set, the binary declares it is safe for use in processes with uid zero\"\n      setuid_safe:\n        value: value & 0x80000 != 0\n        doc: \"When this bit is set, the binary declares it is safe for use in processes when issetugid() is true\"\n      no_reexported_dylibs:\n        value: value & 0x100000 != 0\n        doc: \"When this bit is set on a dylib, the static linker does not need to examine dependent dylibs to see if any are re-exported\"\n      pie:\n        value: value & 0x200000 != 0\n        doc: \"When this bit is set, the OS will load the main executable at a random address. Only used in MH_EXECUTE filetypes.\"\n      dead_strippable_dylib:\n        value: value & 0x400000 != 0\n      has_tlv_descriptors:\n        value: value & 0x800000 != 0\n      no_heap_execution:\n        value: value & 0x1000000 != 0\n      app_extension_safe:\n        value: value & 0x2000000 != 0\n  mach_header:\n    seq:\n      - id: cputype\n        type: u4\n        enum: cpu_type\n      - id: cpusubtype\n        type: u4\n      - id: filetype\n        type: u4\n        enum: file_type\n      - id: ncmds\n        type: u4\n      - id: sizeofcmds\n        type: u4\n      - id: flags\n        type: u4\n      - id: reserved\n        type: u4\n        if: _root.magic == magic_type::macho_be_x64 or _root.magic == magic_type::macho_le_x64\n    instances:\n      flags_obj:\n        type: macho_flags(flags)\n        -webide-parse-mode: eager\n  load_command:\n    -webide-representation: '{type}: {body}'\n    seq:\n      - id: type\n        type: u4\n        enum: load_command_type\n      - id: size\n        -orig-id: cmdsize\n        type: u4\n      - id: body\n        size: size - 8\n        type:\n          switch-on: type\n          cases:\n            'load_command_type::segment_64'              : segment_command_64\n            'load_command_type::dyld_info'               : dyld_info_command\n            'load_command_type::dyld_info_only'          : dyld_info_command\n            'load_command_type::symtab'                  : symtab_command\n            'load_command_type::dysymtab'                : dysymtab_command\n            'load_command_type::load_dylinker'           : dylinker_command\n            'load_command_type::id_dylinker'             : dylinker_command\n            'load_command_type::dyld_environment'        : dylinker_command\n            'load_command_type::uuid'                    : uuid_command\n            'load_command_type::version_min_macosx'      : version_min_command\n            'load_command_type::version_min_iphoneos'    : version_min_command\n            'load_command_type::version_min_tvos'        : version_min_command\n            'load_command_type::version_min_watchos'     : version_min_command\n            'load_command_type::source_version'          : source_version_command\n            'load_command_type::main'                    : entry_point_command\n            'load_command_type::load_dylib'              : dylib_command\n            'load_command_type::load_upward_dylib'       : dylib_command\n            'load_command_type::id_dylib'                : dylib_command\n            'load_command_type::load_weak_dylib'         : dylib_command\n            'load_command_type::lazy_load_dylib'         : dylib_command\n            'load_command_type::reexport_dylib'          : dylib_command\n            'load_command_type::rpath'                   : rpath_command\n            'load_command_type::function_starts'         : linkedit_data_command\n            'load_command_type::data_in_code'            : linkedit_data_command\n            'load_command_type::dylib_code_sign_drs'     : linkedit_data_command\n            'load_command_type::linker_optimization_hint': linkedit_data_command\n            'load_command_type::segment_split_info'      : linkedit_data_command\n            'load_command_type::code_signature'          : code_signature_command\n            'load_command_type::encryption_info_64'      : encryption_info_command\n            'load_command_type::encryption_info'         : encryption_info_command\n            'load_command_type::twolevel_hints'          : twolevel_hints_command\n            'load_command_type::linker_option'           : linker_option_command\n            'load_command_type::sub_framework'           : sub_command\n            'load_command_type::sub_umbrella'            : sub_command\n            'load_command_type::sub_client'              : sub_command\n            'load_command_type::sub_library'             : sub_command\n            'load_command_type::routines_64'             : routines_command_64\n            'load_command_type::routines'                : routines_command\n            'load_command_type::build_version'           : build_version_command\n            'load_command_type::segment'                 : segment_command\n  vm_prot:\n    seq:\n      - id: strip_read\n        type: b1\n        doc: Special marker to support execute-only protection.\n        -orig-id: VM_PROT_STRIP_READ\n      - id: is_mask\n        doc: Indicates to use value as a mask against the actual protection bits.\n        -orig-id: VM_PROT_IS_MASK\n        type: b1\n      - id: reserved0\n        type: b1\n        doc: Reserved (unused) bit.\n      - id: copy\n        type: b1\n        doc: Used when write permission can not be obtained, to mark the entry as COW.\n        -orig-id: VM_PROT_COPY\n      - id: no_change\n        type: b1\n        doc: Used only by memory_object_lock_request to indicate no change to page locks.\n        -orig-id: VM_PROT_NO_CHANGE\n      - id: execute\n        type: b1\n        doc: Execute permission.\n        -orig-id: VM_PROT_EXECUTE\n      - id: write\n        type: b1\n        doc: Write permission.\n        -orig-id: VM_PROT_WRITE\n      - id: read\n        type: b1\n        doc: Read permission.\n        -orig-id: VM_PROT_READ\n      - id: reserved1\n        type: b24\n        doc: Reserved (unused) bits.\n  uleb128:\n    -webide-representation: \"{value:dec}\"\n    seq:\n      - id: b1\n        type: u1\n      - id: b2\n        type: u1\n        if: \"b1 & 0x80 != 0\"\n      - id: b3\n        type: u1\n        if: \"b2 & 0x80 != 0\"\n      - id: b4\n        type: u1\n        if: \"b3 & 0x80 != 0\"\n      - id: b5\n        type: u1\n        if: \"b4 & 0x80 != 0\"\n      - id: b6\n        type: u1\n        if: \"b5 & 0x80 != 0\"\n      - id: b7\n        type: u1\n        if: \"b6 & 0x80 != 0\"\n      - id: b8\n        type: u1\n        if: \"b7 & 0x80 != 0\"\n      - id: b9\n        type: u1\n        if: \"b8 & 0x80 != 0\"\n      - id: b10\n        type: u1\n        if: \"b9 & 0x80 != 0\"\n    instances:\n      value:\n        value: >\n          ((b1  % 128) <<  0) + ((b1 & 0x80 == 0) ? 0 :\n          ((b2  % 128) <<  7) + ((b2 & 0x80 == 0) ? 0 :\n          ((b3  % 128) << 14) + ((b3 & 0x80 == 0) ? 0 :\n          ((b4  % 128) << 21) + ((b4 & 0x80 == 0) ? 0 :\n          ((b5  % 128) << 28) + ((b5 & 0x80 == 0) ? 0 :\n          ((b6  % 128) << 35) + ((b6 & 0x80 == 0) ? 0 :\n          ((b7  % 128) << 42) + ((b7 & 0x80 == 0) ? 0 :\n          ((b8  % 128) << 49) + ((b8 & 0x80 == 0) ? 0 :\n          ((b9  % 128) << 56) + ((b8 & 0x80 == 0) ? 0 :\n          ((b10 % 128) << 63))))))))))\n        -webide-parse-mode: eager\n  segment_command_64:\n    -webide-representation: '{segname} ({initprot}): offs={fileoff}, size={filesize}'\n    seq:\n      - id: segname\n        type: str\n        size: 16\n        pad-right: 0\n        encoding: ascii\n      - id: vmaddr\n        type: u8\n      - id: vmsize\n        type: u8\n      - id: fileoff\n        type: u8\n      - id: filesize\n        type: u8\n      - id: maxprot\n        type: vm_prot\n      - id: initprot\n        type: vm_prot\n      - id: nsects\n        type: u4\n      - id: flags\n        type: u4\n      - id: sections\n        type: section_64\n        repeat: expr\n        repeat-expr: nsects\n    types:\n      section_64:\n        -webide-representation: '{sect_name}: offs={offset}, size={size}'\n        seq:\n          - id: sect_name\n            -orig-id: sectname\n            size: 16\n            type: str\n            pad-right: 0\n            encoding: ascii\n          - id: seg_name\n            -orig-id: segname\n            size: 16\n            type: str\n            pad-right: 0\n            encoding: ascii\n          - id: addr\n            type: u8\n          - id: size\n            type: u8\n          - id: offset\n            type: u4\n          - id: align\n            type: u4\n          - id: reloff\n            type: u4\n          - id: nreloc\n            type: u4\n          - id: flags\n            type: u4\n          - id: reserved1\n            type: u4\n          - id: reserved2\n            type: u4\n          - id: reserved3\n            type: u4\n        instances:\n          data:\n            io: _root._io\n            pos: offset\n            size: size\n            type:\n              switch-on: sect_name\n              cases:\n                \"'__cstring'\":        string_list\n                \"'__objc_methname'\":  string_list\n                \"'__objc_classname'\": string_list\n                \"'__objc_methtype'\":  string_list\n                \"'__nl_symbol_ptr'\":  pointer_list\n                \"'__got'\":            pointer_list\n                \"'__la_symbol_ptr'\":  pointer_list\n                \"'__cfstring'\":       cf_string_list\n                \"'__objc_classlist'\": pointer_list\n                \"'__objc_nlclslist'\": pointer_list\n                \"'__objc_protolist'\": pointer_list\n                \"'__objc_imageinfo'\": pointer_list\n                \"'__objc_selrefs'\":   pointer_list\n                \"'__objc_protorefs'\": pointer_list\n                \"'__objc_classrefs'\": pointer_list\n                \"'__objc_superrefs'\": pointer_list\n                \"'__eh_frame'\":       eh_frame\n        types:\n          # https://reviews.llvm.org/D15502#b8fe88d5\n          eh_frame:\n            seq:\n              - id: items\n                type: eh_frame_item\n                repeat: eos\n          eh_frame_item:\n            -webide-representation: '{body}'\n            seq:\n              - id: length\n                type: u4\n              - id: length64\n                type: u8\n                if: length == 0xffffffff\n              - id: id\n                type: u4\n              - id: body\n                size: length - 4\n                if: length > 0\n                type:\n                  switch-on: id\n                  cases:\n                    0: cie\n            types:\n              char_chain:\n                seq:\n                  - id: chr\n                    type: u1\n                  - id: next\n                    type: char_chain\n                    if: chr != 0\n              cie:\n                -webide-representation: 'v:{version:dec} aug:{augmentation_string} code:{code_alignment_factor} data:{data_alignment_factor} returnReg:{return_address_register}'\n                seq:\n                  - id: version\n                    type: u1\n                  #- id: augmentation_string\n                  #  type: strz\n                  #  encoding: ascii\n                  - id: aug_str\n                    type: char_chain\n                  #- id: eh_data\n                  #  type: u8\n                  #  if: \"'eh' in augmentation_string\"\n                  - id: code_alignment_factor\n                    type: uleb128\n                  - id: data_alignment_factor\n                    type: uleb128\n                  - id: return_address_register\n                    type: u1\n                  - id: augmentation\n                    type: augmentation_entry\n                    if: 'aug_str.chr == 122'\n              augmentation_entry:\n                seq:\n                  - id: length\n                    type: uleb128\n                  - id: fde_pointer_encoding\n                    type: u1\n                    if: _parent.aug_str.next.chr == 82\n          string_list:\n            seq:\n              - id: strings\n                type: strz\n                encoding: ascii\n                repeat: eos\n          pointer_list:\n            seq:\n              - id: items\n                type: u8\n                repeat: eos\n          cf_string:\n            -webide-representation: \"isa={isa}, info={info}, data={data}, length={length}\"\n            seq:\n              - id: isa\n                type: u8\n              - id: info\n                type: u8\n              - id: data\n                type: u8\n              - id: length\n                type: u8\n          cf_string_list:\n            seq:\n              - id: items\n                type: cf_string\n                repeat: eos\n  dyld_info_command:\n    -webide-representation: 'rebase={rebase_off}, bind={bind_off}, weakBind={weak_bind_off}, lazyBind={lazy_bind_off}, export={export_off}'\n    seq:\n      - id: rebase_off\n        type: u4\n      - id: rebase_size\n        type: u4\n      - id: bind_off\n        type: u4\n      - id: bind_size\n        type: u4\n      - id: weak_bind_off\n        type: u4\n      - id: weak_bind_size\n        type: u4\n      - id: lazy_bind_off\n        type: u4\n      - id: lazy_bind_size\n        type: u4\n      - id: export_off\n        type: u4\n      - id: export_size\n        type: u4\n    instances:\n      rebase:\n        io: _root._io\n        pos: rebase_off\n        size: rebase_size\n        type: rebase_data\n        if: rebase_size != 0\n      bind:\n        io: _root._io\n        pos: bind_off\n        size: bind_size\n        type: bind_data\n        if: bind_size != 0\n      weak_bind:\n        io: _root._io\n        pos: weak_bind_off\n        size: weak_bind_size\n        type: bind_data\n        if: weak_bind_size != 0\n      lazy_bind:\n        io: _root._io\n        pos: lazy_bind_off\n        size: lazy_bind_size\n        type: bind_data\n        if: lazy_bind_size != 0\n      exports:\n        io: _root._io\n        pos: export_off\n        size: export_size\n        type: export_node\n        if: export_size != 0\n    types:\n      rebase_data:\n        seq:\n          - id: items\n            type: rebase_item\n            repeat: until\n            repeat-until: _.opcode == opcode::done\n        types:\n          rebase_item:\n            -webide-representation: \"{opcode}, imm:{immediate}, uleb:{uleb}, skip:{skip}\"\n            seq:\n              - id: opcode_and_immediate\n                type: u1\n              - id: uleb\n                type: uleb128\n                if: >\n                  opcode == opcode::set_segment_and_offset_uleb or\n                  opcode == opcode::add_address_uleb or\n                  opcode == opcode::do_rebase_uleb_times or\n                  opcode == opcode::do_rebase_add_address_uleb or\n                  opcode == opcode::do_rebase_uleb_times_skipping_uleb\n              - id: skip\n                type: uleb128\n                if: \"opcode == opcode::do_rebase_uleb_times_skipping_uleb\"\n            instances:\n              opcode:\n                value: \"opcode_and_immediate & 0xf0\"\n                enum: opcode\n                -webide-parse-mode: eager\n              immediate:\n                value: \"opcode_and_immediate & 0x0f\"\n                -webide-parse-mode: eager\n        enums:\n          opcode:\n            0x00: done\n            0x10: set_type_immediate\n            0x20: set_segment_and_offset_uleb\n            0x30: add_address_uleb\n            0x40: add_address_immediate_scaled\n            0x50: do_rebase_immediate_times\n            0x60: do_rebase_uleb_times\n            0x70: do_rebase_add_address_uleb\n            0x80: do_rebase_uleb_times_skipping_uleb\n      bind_item:\n        -webide-representation: \"{opcode}, imm:{immediate}, uleb:{uleb}, skip:{skip}, symbol:{symbol}\"\n        seq:\n          - id: opcode_and_immediate\n            type: u1\n          - id: uleb\n            type: uleb128\n            if: >\n              opcode == bind_opcode::set_dylib_ordinal_uleb or\n              opcode == bind_opcode::set_append_sleb or\n              opcode == bind_opcode::set_segment_and_offset_uleb or\n              opcode == bind_opcode::add_address_uleb or\n              opcode == bind_opcode::do_bind_add_address_uleb or\n              opcode == bind_opcode::do_bind_uleb_times_skipping_uleb\n          - id: skip\n            type: uleb128\n            if: \"opcode == bind_opcode::do_bind_uleb_times_skipping_uleb\"\n          - id: symbol\n            type: strz\n            if: \"opcode == bind_opcode::set_symbol_trailing_flags_immediate\"\n            encoding: ascii\n        instances:\n          opcode:\n            value: \"opcode_and_immediate & 0xf0\"\n            enum: bind_opcode\n            -webide-parse-mode: eager\n          immediate:\n            value: \"opcode_and_immediate & 0x0f\"\n            -webide-parse-mode: eager\n      bind_data:\n        seq:\n          - id: items\n            type: bind_item\n            repeat: eos\n      export_node:\n        -webide-representation: \"{children_count} children, term_size={terminal_size.value}\"\n        seq:\n          - id: terminal_size\n            type: uleb128\n          - id: children_count\n            type: u1\n          - id: children\n            type: child\n            repeat: expr\n            repeat-expr: children_count\n          - id: terminal\n            size: terminal_size.value\n        types:\n          child:\n            -webide-representation: \"{name}: {node_offset}\"\n            seq:\n              - id: name\n                type: strz\n                encoding: ascii\n              - id: node_offset\n                type: uleb128\n            instances:\n              value:\n                pos: node_offset.value\n                type: export_node\n    enums:\n      bind_opcode:\n        0x00: done\n        0x10: set_dylib_ordinal_immediate\n        0x20: set_dylib_ordinal_uleb\n        0x30: set_dylib_special_immediate\n        0x40: set_symbol_trailing_flags_immediate\n        0x50: set_type_immediate\n        0x60: set_append_sleb\n        0x70: set_segment_and_offset_uleb\n        0x80: add_address_uleb\n        0x90: do_bind\n        0xa0: do_bind_add_address_uleb\n        0xb0: do_bind_add_address_immediate_scaled\n        0xc0: do_bind_uleb_times_skipping_uleb\n  symtab_command:\n    -webide-representation: \"symbols: {n_syms:dec}, strtab: {str_off}\"\n    seq:\n      - id: sym_off\n        -orig-id: symoff\n        type: u4\n      - id: n_syms\n        -orig-id: nsyms\n        type: u4\n      - id: str_off\n        -orig-id: stroff\n        type: u4\n      - id: str_size\n        -orig-id: strsize\n        type: u4\n    instances:\n      symbols:\n        io: _root._io\n        pos: sym_off\n        type:\n          switch-on: _root.magic\n          cases:\n            magic_type::macho_le_x64 : nlist_64\n            magic_type::macho_be_x64 : nlist_64\n            magic_type::macho_le_x86 : nlist\n            magic_type::macho_be_x86 : nlist\n        repeat: expr\n        repeat-expr: n_syms\n      strs:\n        io: _root._io\n        pos: str_off\n        size: str_size\n        type: str_table\n    types:\n      str_table:\n        seq:\n            # NOTE:  This may not always be a u4, I've also seen \" \" (0x20 0x00)\n          - id: unknown\n            type: u4\n          - id: items\n            type: strz\n            encoding: utf-8\n            repeat: until\n            repeat-until: _ == \"\"\n            eos-error: false\n      nlist_64:\n        -webide-representation: \"un={un} type={type} sect={sect} desc={desc} value={value}\"\n        seq:\n          - id: un\n            type: u4\n          - id: type\n            type: u1\n          - id: sect\n            type: u1\n          - id: desc\n            type: u2\n          - id: value\n            type: u8\n        instances:\n          name:\n            pos: _parent.str_off + un\n            type: strz\n            encoding: utf-8\n            if: un != 0\n      nlist:\n        -webide-representation: \"un={un} type={type} sect={sect} desc={desc} value={value}\"\n        seq:\n          - id: un\n            type: u4\n          - id: type\n            type: u1\n          - id: sect\n            type: u1\n          - id: desc\n            type: u2\n          - id: value\n            type: u4\n        instances:\n          name:\n            pos: _parent.str_off + un\n            type: strz\n            encoding: utf-8\n            if: un != 0\n  dysymtab_command:\n    seq:\n      - id: i_local_sym\n        -orig-id: ilocalsym\n        type: u4\n      - id: n_local_sym\n        -orig-id: nlocalsym\n        type: u4\n      - id: i_ext_def_sym\n        -orig-id: iextdefsym\n        type: u4\n      - id: n_ext_def_sym\n        -orig-id: nextdefsym\n        type: u4\n      - id: i_undef_sym\n        -orig-id: iundefsym\n        type: u4\n      - id: n_undef_sym\n        -orig-id: nundefsym\n        type: u4\n      - id: toc_off\n        -orig-id: tocoff\n        type: u4\n      - id: n_toc\n        -orig-id: ntoc\n        type: u4\n      - id: mod_tab_off\n        -orig-id: modtaboff\n        type: u4\n      - id: n_mod_tab\n        -orig-id: nmodtab\n        type: u4\n      - id: ext_ref_sym_off\n        -orig-id: extrefsymoff\n        type: u4\n      - id: n_ext_ref_syms\n        -orig-id: nextrefsyms\n        type: u4\n      - id: indirect_sym_off\n        -orig-id: indirectsymoff\n        type: u4\n      - id: n_indirect_syms\n        -orig-id: nindirectsyms\n        type: u4\n      - id: ext_rel_off\n        -orig-id: extreloff\n        type: u4\n      - id: n_ext_rel\n        -orig-id: nextrel\n        type: u4\n      - id: loc_rel_off\n        -orig-id: locreloff\n        type: u4\n      - id: n_loc_rel\n        -orig-id: nlocrel\n        type: u4\n    instances:\n      indirect_symbols:\n        io: _root._io\n        pos: indirect_sym_off\n        type: u4\n        repeat: expr\n        repeat-expr: n_indirect_syms\n  lc_str:\n    -webide-representation: '{value}'\n    seq:\n      - id: length\n        -orig-id: offset\n        type: u4\n      - id: value\n        -orig-id: ptr\n        type: strz\n        encoding: UTF-8\n  dylinker_command:\n    -webide-representation: '{name}'\n    seq:\n      - id: name\n        type: lc_str\n  uuid_command:\n    -webide-representation: 'uuid={uuid}'\n    seq:\n      - id: uuid\n        size: 16\n  version:\n    -webide-representation: '{major:dec}.{minor:dec}'\n    seq:\n      - id: p1\n        type: u1\n      - id: minor\n        type: u1\n      - id: major\n        type: u1\n      - id: release\n        type: u1\n  encryption_info_command:\n    seq:\n      - id: cryptoff\n        type: u4\n      - id: cryptsize\n        type: u4\n      - id: cryptid\n        type: u4\n      - id: pad\n        type: u4\n        if: _root.magic == magic_type::macho_be_x64 or _root.magic == magic_type::macho_le_x64\n  twolevel_hints_command:\n    seq:\n      - id: offset\n        type: u4\n      - id: num_hints\n        -orig-id: nhints\n        type: u4\n  linker_option_command:\n    seq:\n      - id: num_strings\n        -orig-id: count\n        type: u4\n      - id: strings\n        type: strz\n        encoding: utf-8\n        repeat: expr\n        repeat-expr: num_strings\n  sub_command:\n    seq:\n      - id: name\n        type: lc_str\n  routines_command_64:\n    seq:\n      - id: init_address\n        type: u8\n      - id: init_module\n        type: u8\n      - id: reserved\n        size: 48 # u8 * 6\n  routines_command:\n    seq:\n      - id: init_address\n        type: u4\n      - id: init_module\n        type: u4\n      - id: reserved\n        size: 24 # u4 * 6\n  version_min_command:\n    -webide-representation: 'v:{version}, r:{reserved}'\n    seq:\n      - id: version\n        type: version\n      - id: sdk\n        type: version\n  source_version_command:\n    -webide-representation: 'v:{version:dec}'\n    seq:\n      - id: version\n        type: u8\n  entry_point_command:\n    -webide-representation: 'entry_off={entry_off}, stack_size={stack_size}'\n    seq:\n      - id: entry_off\n        -orig-id: entryoff\n        type: u8\n      - id: stack_size\n        -orig-id: stacksize\n        type: u8\n  dylib_command:\n    -webide-representation: '{name}'\n    seq:\n      - id: name_offset\n        type: u4\n      - id: timestamp\n        type: u4\n      - id: current_version\n        type: u4\n      - id: compatibility_version\n        type: u4\n      - id: name\n        type: strz\n        encoding: utf-8\n  rpath_command:\n    -webide-representation: '{path}'\n    seq:\n      - id: path_offset\n        type: u4\n      - id: path\n        type: strz\n        encoding: utf-8\n  linkedit_data_command:\n    -webide-representation: 'offs={data_off}, size={data_size}'\n    seq:\n      - id: data_off\n        -orig-id: dataoff\n        type: u4\n      - id: data_size\n        -orig-id: datasize\n        type: u4\n  code_signature_command:\n    -webide-representation: 'offs={data_off}, size={data_size}'\n    seq:\n      - id: data_off\n        type: u4\n      - id: data_size\n        type: u4\n    instances:\n      code_signature:\n        io: _root._io\n        pos: data_off\n        size: data_size\n        type: cs_blob\n  cs_blob:\n    seq:\n      - id: magic\n        type: u4be\n        enum: cs_magic\n      - id: length\n        type: u4be\n      - id: body\n        size: length - 8\n        type:\n          switch-on: magic\n          cases:\n            'cs_magic::requirement'       : requirement\n            'cs_magic::requirements'      : requirements\n            'cs_magic::code_directory'    : code_directory\n            'cs_magic::entitlements'      : entitlements\n            'cs_magic::der_entitlements'  : asn1_der\n            'cs_magic::blob_wrapper'      : blob_wrapper\n            'cs_magic::embedded_signature': super_blob\n            'cs_magic::detached_signature': super_blob\n    enums:\n      cs_magic:\n        0xfade0c00: requirement        # CSMAGIC_REQUIREMENT\n        0xfade0c01: requirements       # CSMAGIC_REQUIREMENTS\n        0xfade0c02: code_directory     # CSMAGIC_CODEDIRECTORY\n        0xfade7171: entitlements       # CSMAGIC_EMBEDDED_ENTITLEMENTS\n        0xfade7172: der_entitlements   # CSMAGIC_EMBEDDED_DER_ENTITLEMENTS\n        0xfade0b01: blob_wrapper       # CSMAGIC_BLOBWRAPPER\n        0xfade0cc0: embedded_signature # CSMAGIC_EMBEDDED_SIGNATURE\n        0xfade0cc1: detached_signature # CSMAGIC_DETACHED_SIGNATURE\n    types:\n      code_directory:\n        seq:\n          - id: version\n            type: u4be\n          - id: flags\n            type: u4be\n          - id: hash_offset\n            type: u4be\n          - id: ident_offset\n            type: u4be\n          - id: n_special_slots\n            type: u4be\n          - id: n_code_slots\n            type: u4be\n          - id: code_limit\n            type: u4be\n          - id: hash_size\n            type: u1\n          - id: hash_type\n            type: u1\n          - id: spare1\n            type: u1\n          - id: page_size\n            type: u1\n          - id: spare2\n            type: u4be\n          - id: scatter_offset\n            type: u4be\n            if: version >= 0x20100\n          - id: team_id_offset\n            type: u4be\n            if: version >= 0x20200\n        instances:\n          ident:\n            pos: ident_offset - 8\n            type: strz\n            encoding: utf-8\n            -webide-parse-mode: eager\n          team_id:\n            pos: team_id_offset - 8\n            type: strz\n            encoding: utf-8\n            -webide-parse-mode: eager\n          hashes:\n            pos: hash_offset - 8 - hash_size * n_special_slots\n            size: hash_size\n            repeat: expr\n            repeat-expr: n_special_slots + n_code_slots\n      blob_index:\n        seq:\n          - id: type\n            type: u4be\n            enum: csslot_type\n          - id: offset\n            type: u4be\n        instances:\n          blob:\n            io: _parent._io\n            pos: offset - 8\n            size-eos: true\n            type: cs_blob\n        enums:\n          csslot_type:\n            0:       code_directory             # CSSLOT_CODEDIRECTORY\n            1:       info_slot                  # CSSLOT_INFOSLOT\n            2:       requirements               # CSSLOT_REQUIREMENTS\n            3:       resource_dir               # CSSLOT_RESOURCEDIR\n            4:       application                # CSSLOT_APPLICATION\n            5:       entitlements               # CSSLOT_ENTITLEMENTS\n            7:       der_entitlements           # CSSLOT_DER_ENTITLEMENTS\n            0x1000:  alternate_code_directories # CSSLOT_ALTERNATE_CODEDIRECTORIES\n            0x10000: signature_slot             # CSSLOT_SIGNATURESLOT\n      data:\n        -webide-representation: \"{value}\"\n        seq:\n          - id: length\n            type: u4be\n          - id: value\n            size: length\n          - id: padding\n            size: -length % 4\n      match:\n        -webide-representation: \"{match_op} {data.value:str}\"\n        seq:\n          - id: match_op\n            type: u4be\n            enum: op\n          - id: data\n            type: data\n            if: 'match_op != op::exists'\n        enums:\n          op:\n            0: exists\n            1: equal\n            2: contains\n            3: begins_with\n            4: ends_with\n            5: less_than\n            6: greater_than\n            7: less_equal\n            8: greater_equal\n      expr:\n        -webide-representation: '{data}'\n        seq:\n          - id: op\n            type: u4be\n            enum: op_enum\n          - id: data\n            type:\n              switch-on: op\n              cases:\n                #'op_enum::false'               : 'false'\n                #'op_enum::true'                : 'true'\n                'op_enum::ident'               : ident_expr\n                #'op_enum::apple_anchor'        : 'anchor apple'\n                'op_enum::anchor_hash'         : anchor_hash_expr\n                'op_enum::info_key_value'      : data\n                'op_enum::and_op'              : and_expr\n                'op_enum::or_op'               : or_expr\n                'op_enum::cd_hash'             : data\n                'op_enum::not_op'              : expr\n                'op_enum::info_key_field'      : info_key_field_expr\n                'op_enum::cert_field'          : cert_field_expr\n                'op_enum::trusted_cert'        : cert_slot_expr\n                #'op_enum::trusted_certs'       : 'anchor trusted'\n                'op_enum::cert_generic'        : cert_generic_expr\n                'op_enum::apple_generic_anchor': apple_generic_anchor_expr\n                'op_enum::entitlement_field'   : entitlement_field_expr\n        enums:\n          op_enum:\n            0: 'false'               # unconditionally false\n            1: 'true'                # unconditionally true\n            2: ident                 # match canonical code [string]\n            3: apple_anchor          # signed by Apple as Apple's product (\"anchor apple\")\n            4: anchor_hash           # match anchor [cert hash]\n            5: info_key_value        # *legacy* - use opInfoKeyField [key; value]\n            6: and_op                # binary prefix expr AND expr [expr; expr]\n            7: or_op                 # binary prefix expr OR expr\n            8: cd_hash               # match hash of CodeDirectory directly\n            9: not_op                # logical inverse\n            10: info_key_field       # Info.plist key field [string; match suffix]\n            11: cert_field           # Certificate field [cert index; field name; match suffix]\n            12: trusted_cert         # require trust settings to approve one particular cert [cert index]\n            13: trusted_certs        # require trust settings to approve the cert chain\n            14: cert_generic         # Certificate component by OID [cert index; oid; match suffix]\n            15: apple_generic_anchor # signed by Apple in any capacity (\"anchor apple generic\")\n            16: entitlement_field    # entitlement dictionary field [string; match suffix]\n          cert_slot:\n            0xffffffff: anchor_cert\n            0: left_cert\n        types:\n          ident_expr:\n            -webide-representation: \"identifier {identifier.value:str}\"\n            seq:\n              - id: identifier\n                type: data\n          apple_generic_anchor_expr:\n            -webide-representation: \"anchor apple generic\"\n            instances:\n              value:\n                value: '\"anchor apple generic\"'\n          cert_slot_expr:\n            seq:\n              - id: value\n                type: u4be\n                enum: cert_slot\n          and_expr:\n            -webide-representation: \"({left}) AND ({right})\"\n            seq:\n              - id: left\n                type: expr\n              - id: right\n                type: expr\n          or_expr:\n            -webide-representation: \"({left}) OR ({right})\"\n            seq:\n              - id: left\n                type: expr\n              - id: right\n                type: expr\n          anchor_hash_expr:\n            seq:\n              - id: cert_slot\n                type: u4be\n                enum: cert_slot\n              - id: data\n                type: data\n          info_key_field_expr:\n            seq:\n              - id: data\n                type: data\n              - id: match\n                type: match\n          entitlement_field_expr:\n            seq:\n              - id: data\n                type: data\n              - id: match\n                type: match\n          cert_field_expr:\n            -webide-representation: \"{cert_slot}[{data.value:str}] {match}\"\n            seq:\n              - id: cert_slot\n                type: u4be\n                enum: cert_slot\n              - id: data\n                type: data\n              - id: match\n                type: match\n          cert_generic_expr:\n            -webide-representation: \"{cert_slot}[{data.value:hex}] {match}\"\n            seq:\n              - id: cert_slot\n                type: u4be\n                enum: cert_slot\n              - id: data\n                type: data\n              - id: match\n                type: match\n      requirement:\n        seq:\n          - id: kind\n            type: u4be\n          - id: expr\n            type: expr\n      entitlements:\n        -webide-representation: \"{data:str}\"\n        seq:\n          - id: data\n            size-eos: true\n      requirements_blob_index:\n        seq:\n          - id: type\n            type: u4be\n            enum: requirement_type\n          - id: offset\n            type: u4be\n        instances:\n          value:\n            pos: offset - 8\n            type: cs_blob\n        enums:\n          requirement_type:\n            1: host        # kSecHostRequirementType\n            2: guest       # kSecGuestRequirementType\n            3: designated  # kSecDesignatedRequirementtype\n            4: library     # kSecLibraryRequirementType\n      requirements:\n        seq:\n          - id: count\n            type: u4be\n          - id: items\n            type: requirements_blob_index\n            repeat: expr\n            repeat-expr: count\n      blob_wrapper:\n        seq:\n          - id: data\n            size-eos: true\n      super_blob:\n        seq:\n          - id: count\n            type: u4be\n          - id: blobs\n            type: blob_index\n            repeat: expr\n            repeat-expr: count\n  build_version_command:\n    seq:\n      - id: platform\n        type: u4\n      - id: minos\n        type: u4\n      - id: sdk\n        type: u4\n      - id: ntools\n        type: u4\n      - id: tools\n        type: build_tool_version\n        repeat: expr\n        repeat-expr: ntools\n    types:\n      build_tool_version:\n        seq:\n          - id: tool\n            type: u4\n          - id: version\n            type: u4\n  segment_command:\n    seq:\n      - id: segname\n        type: str\n        size: 16\n        pad-right: 0\n        encoding: ascii\n      - id: vmaddr\n        type: u4\n      - id: vmsize\n        type: u4\n      - id: fileoff\n        type: u4\n      - id: filesize\n        type: u4\n      - id: maxprot\n        type: vm_prot\n      - id: initprot\n        type: vm_prot\n      - id: nsects\n        type: u4\n      - id: flags\n        type: u4\n      - id: sections\n        type: section\n        repeat: expr\n        repeat-expr: nsects\n    types:\n      section:\n        seq:\n          - id: sect_name\n            -orig-id: sectname\n            size: 16\n            type: str\n            pad-right: 0\n            encoding: ascii\n          - id: seg_name\n            -orig-id: segname\n            size: 16\n            type: str\n            pad-right: 0\n            encoding: ascii\n          - id: addr\n            type: u4\n          - id: size\n            type: u4\n          - id: offset\n            type: u4\n          - id: align\n            type: u4\n          - id: reloff\n            type: u4\n          - id: nreloc\n            type: u4\n          - id: flags\n            type: u4\n          - id: reserved1\n            type: u4\n          - id: reserved2\n            type: u4\n        instances:\n          data:\n            io: _root._io\n            pos: offset\n            size: size\n"
  },
  {
    "id": "ksy_mach_o_fat",
    "name": "macOS Mach-O multiarch (\"fat\") binary",
    "category": "Executable",
    "metadata": {
      "isGenerated": true,
      "fileExtensions": [],
      "description": "macOS Mach-O multiarch (\"fat\") binary",
      "originalCategory": "executable",
      "filePath": "executable/mach_o_fat.ksy",
      "signature": {
        "offset": 0,
        "bytes": [
          202,
          254,
          186,
          190
        ]
      },
      "endian": "be"
    },
    "content": "meta:\n  id: mach_o_fat\n  title: macOS Mach-O multiarch (\"fat\") binary\n  license: CC0-1.0\n  imports:\n    - mach_o\n  endian: be\n\ndoc: |\n  This is a simple container format that encapsulates multiple Mach-O files,\n  each generally for a different architecture. XNU can execute these files just\n  like single-arch Mach-Os and will pick the appropriate entry.\n\ndoc-ref: https://opensource.apple.com/source/xnu/xnu-7195.121.3/EXTERNAL_HEADERS/mach-o/fat.h.auto.html\n\nseq:\n  - id: magic\n    contents: [0xca, 0xfe, 0xba, 0xbe]\n  - id: num_fat_arch\n    -orig-id: nfat_arch\n    type: u4\n  - id: fat_archs\n    type: fat_arch\n    repeat: expr\n    repeat-expr: num_fat_arch\n\ntypes:\n  fat_arch:\n    seq:\n      - id: cpu_type\n        -orig-id: cputype\n        type: u4\n        enum: mach_o::cpu_type\n      - id: cpu_subtype\n        -orig-id: cpusubtype\n        type: u4\n      - id: ofs_object\n        -orig-id: offset\n        type: u4\n      - id: len_object\n        -orig-id: size\n        type: u4\n      - id: align\n        type: u4\n\n    instances:\n      object:\n        pos: ofs_object\n        size: len_object\n        type: mach_o\n"
  },
  {
    "id": "ksy_microsoft_pe",
    "name": "Microsoft PE (Portable Executable) file format",
    "category": "Executable",
    "metadata": {
      "isGenerated": true,
      "fileExtensions": [
        "exe",
        "dll",
        "sys"
      ],
      "description": "Microsoft PE (Portable Executable) file format",
      "originalCategory": "executable",
      "filePath": "executable/microsoft_pe.ksy",
      "endian": "le"
    },
    "content": "meta:\n  id: microsoft_pe\n  title: Microsoft PE (Portable Executable) file format\n  application: Microsoft Windows\n  file-extension:\n    - exe\n    - dll\n    - sys\n  xref:\n    justsolve: Portable_Executable\n    pronom: x-fmt/411\n    wikidata: Q1076355\n  tags:\n    - executable\n    - windows\n  license: CC0-1.0\n  ks-version: 0.7\n  endian: le\ndoc-ref: https://learn.microsoft.com/en-us/windows/win32/debug/pe-format\nseq:\n  - id: mz\n    type: mz_placeholder\ninstances:\n  pe:\n    pos: mz.ofs_pe\n    type: pe_header\nenums:\n  pe_format:\n    0x107: rom_image\n    0x10b: pe32\n    0x20b: pe32_plus\ntypes:\n  mz_placeholder:\n    seq:\n      - id: magic\n        contents: \"MZ\"\n      - id: data1\n        size: 0x3a\n      - id: ofs_pe\n        type: u4\n        doc: In PE file, an offset to PE header\n  pe_header:\n    seq:\n      - id: pe_signature\n        contents: [\"PE\", 0, 0]\n      - id: coff_hdr\n        type: coff_header\n      - id: optional_hdr\n        type: optional_header\n        size: coff_hdr.size_of_optional_header\n      - id: sections\n        repeat: expr\n        repeat-expr: coff_hdr.number_of_sections\n        type: section\n    instances:\n      certificate_table:\n        pos: optional_hdr.data_dirs.certificate_table.virtual_address\n        size: optional_hdr.data_dirs.certificate_table.size\n        type: certificate_table\n        if: optional_hdr.data_dirs.certificate_table.virtual_address != 0\n  coff_header:\n    doc-ref: 3.3. COFF File Header (Object and Image)\n    seq:\n      - id: machine\n        type: u2\n        enum: machine_type\n      - id: number_of_sections\n        type: u2\n      - id: time_date_stamp\n        type: u4\n      - id: pointer_to_symbol_table\n        type: u4\n      - id: number_of_symbols\n        type: u4\n      - id: size_of_optional_header\n        type: u2\n      - id: characteristics\n        type: u2\n    instances:\n      symbol_table_size:\n        value: number_of_symbols * 18\n      symbol_name_table_offset:\n        value: pointer_to_symbol_table + symbol_table_size\n      symbol_name_table_size:\n        pos: symbol_name_table_offset\n        type: u4\n      symbol_table:\n        pos: pointer_to_symbol_table\n        type: coff_symbol\n        repeat: expr\n        repeat-expr: number_of_symbols\n    enums:\n      # Don't forget to update the `machine_type` enum in `executable/uefi_te.ksy` when\n      # you modify this one.\n      #\n      # https://learn.microsoft.com/en-us/windows/win32/debug/pe-format#machine-types\n      machine_type:\n        0x0:\n          id: unknown\n          doc: The content of this field is assumed to be applicable to any machine type\n        0x184:\n          id: alpha\n          doc: Alpha AXP, 32-bit address space\n        0x284:\n          id: alpha64_or_axp64\n          -orig-id:\n            - IMAGE_FILE_MACHINE_ALPHA64\n            - IMAGE_FILE_MACHINE_AXP64\n          doc: |\n            > Alpha 64, 64-bit address space\n            or\n            > AXP 64 (Same as Alpha 64)\n        0x1d3:\n          id: am33\n          doc: Matsushita AM33\n        0x8664:\n          id: amd64\n          doc: x64\n        0x1c0:\n          id: arm\n          doc: ARM little endian\n        0xaa64:\n          id: arm64\n          doc: ARM64 little endian\n        0x1c4:\n          id: arm_nt\n          -orig-id: IMAGE_FILE_MACHINE_ARMNT\n          doc: ARM Thumb-2 little endian\n        0xebc:\n          id: ebc\n          doc: EFI byte code\n        0x14c:\n          id: i386\n          doc: Intel 386 or later processors and compatible processors\n        0x200:\n          id: ia64\n          doc: Intel Itanium processor family\n        0x6232:\n          id: loongarch32\n          doc: LoongArch 32-bit processor family\n        0x6264:\n          id: loongarch64\n          doc: LoongArch 64-bit processor family\n        0x9041:\n          id: m32r\n          doc: Mitsubishi M32R little endian\n        0x266:\n          id: mips16\n          doc: MIPS16\n        0x366:\n          id: mips_fpu\n          -orig-id: IMAGE_FILE_MACHINE_MIPSFPU\n          doc: MIPS with FPU\n        0x466:\n          id: mips16_fpu\n          -orig-id: IMAGE_FILE_MACHINE_MIPSFPU16\n          doc: MIPS16 with FPU\n        0x1f0:\n          id: powerpc\n          doc: Power PC little endian\n        0x1f1:\n          id: powerpc_fp\n          -orig-id: IMAGE_FILE_MACHINE_POWERPCFP\n          doc: Power PC with floating point support\n        0x166:\n          id: r4000\n          doc: MIPS little endian\n        0x5032:\n          id: riscv32\n          doc: RISC-V 32-bit address space\n        0x5064:\n          id: riscv64\n          doc: RISC-V 64-bit address space\n        0x5128:\n          id: riscv128\n          doc: RISC-V 128-bit address space\n        0x1a2:\n          id: sh3\n          doc: Hitachi SH3\n        0x1a3:\n          id: sh3_dsp\n          -orig-id: IMAGE_FILE_MACHINE_SH3DSP\n          doc: Hitachi SH3 DSP\n        0x1a6:\n          id: sh4\n          doc: Hitachi SH4\n        0x1a8:\n          id: sh5\n          doc: Hitachi SH5\n        0x1c2:\n          id: thumb\n          doc: Thumb\n        0x169:\n          id: wce_mips_v2\n          -orig-id: IMAGE_FILE_MACHINE_WCEMIPSV2\n          doc: MIPS little-endian WCE v2\n  coff_symbol:\n    seq:\n      - id: name_annoying\n        type: annoyingstring\n        size: 8\n      #- id: name_zeroes\n      #  type: u4\n      #- id: name_offset\n      #  type: u4\n      - id: value\n        type: u4\n      - id: section_number\n        type: u2\n      - id: type\n        type: u2\n      - id: storage_class\n        type: u1\n      - id: number_of_aux_symbols\n        type: u1\n    instances:\n      #effective_name:\n      #  value: name_zeroes == 0 ? name_from_offset : '\"fixme\"'\n      #name_from_offset:\n      #  io: _root._io\n      #  pos: name_zeroes == 0 ? _parent.symbol_name_table_offset + name_offset : 0\n      #  type: str\n      #  terminator: 0\n      #  encoding: ascii\n      section:\n        value: _root.pe.sections[section_number - 1]\n      data:\n        pos: section.pointer_to_raw_data + value\n        size: 1\n  annoyingstring:\n    -webide-representation: '{name}'\n    instances:\n      name_zeroes:\n        pos: 0\n        type: u4\n      name_offset:\n        pos: 4\n        type: u4\n      name_from_offset:\n        io: _root._io\n        pos: 'name_zeroes == 0 ? _parent._parent.symbol_name_table_offset + name_offset : 0'\n        type: str\n        terminator: 0\n        eos-error: false\n        encoding: ascii\n        if: name_zeroes == 0\n      name_from_short:\n        pos: 0\n        type: str\n        terminator: 0\n        eos-error: false\n        encoding: ascii\n        if: name_zeroes != 0\n      name:\n        value: 'name_zeroes == 0 ? name_from_offset : name_from_short'\n  optional_header:\n    seq:\n      - id: std\n        type: optional_header_std\n      - id: windows\n        type: optional_header_windows\n      - id: data_dirs\n        type: optional_header_data_dirs\n  optional_header_std:\n    seq:\n      - id: format\n        type: u2\n        enum: pe_format\n      - id: major_linker_version\n        type: u1\n      - id: minor_linker_version\n        type: u1\n      - id: size_of_code\n        type: u4\n      - id: size_of_initialized_data\n        type: u4\n      - id: size_of_uninitialized_data\n        type: u4\n      - id: address_of_entry_point\n        type: u4\n      - id: base_of_code\n        type: u4\n      - id: base_of_data\n        type: u4\n        if: format == pe_format::pe32\n  optional_header_windows:\n    seq:\n      - id: image_base_32\n        type: u4\n        if: _parent.std.format == pe_format::pe32\n      - id: image_base_64\n        type: u8\n        if: _parent.std.format == pe_format::pe32_plus\n      - id: section_alignment\n        type: u4\n      - id: file_alignment\n        type: u4\n      - id: major_operating_system_version\n        type: u2\n      - id: minor_operating_system_version\n        type: u2\n      - id: major_image_version\n        type: u2\n      - id: minor_image_version\n        type: u2\n      - id: major_subsystem_version\n        type: u2\n      - id: minor_subsystem_version\n        type: u2\n      - id: win32_version_value\n        type: u4\n      - id: size_of_image\n        type: u4\n      - id: size_of_headers\n        type: u4\n      - id: check_sum\n        type: u4\n      - id: subsystem\n        type: u2\n        enum: subsystem_enum\n      - id: dll_characteristics\n        type: u2\n      - id: size_of_stack_reserve_32\n        type: u4\n        if: _parent.std.format == pe_format::pe32\n      - id: size_of_stack_reserve_64\n        type: u8\n        if: _parent.std.format == pe_format::pe32_plus\n      - id: size_of_stack_commit_32\n        type: u4\n        if: _parent.std.format == pe_format::pe32\n      - id: size_of_stack_commit_64\n        type: u8\n        if: _parent.std.format == pe_format::pe32_plus\n      - id: size_of_heap_reserve_32\n        type: u4\n        if: _parent.std.format == pe_format::pe32\n      - id: size_of_heap_reserve_64\n        type: u8\n        if: _parent.std.format == pe_format::pe32_plus\n      - id: size_of_heap_commit_32\n        type: u4\n        if: _parent.std.format == pe_format::pe32\n      - id: size_of_heap_commit_64\n        type: u8\n        if: _parent.std.format == pe_format::pe32_plus\n      - id: loader_flags\n        type: u4\n      - id: number_of_rva_and_sizes\n        type: u4\n    enums:\n      subsystem_enum:\n        0: unknown\n        1: native\n        2: windows_gui\n        3: windows_cui\n        7: posix_cui\n        9: windows_ce_gui\n        10: efi_application\n        11: efi_boot_service_driver\n        12: efi_runtime_driver\n        13: efi_rom\n        14: xbox\n        16: windows_boot_application\n  optional_header_data_dirs:\n    seq:\n      - id: export_table\n        type: data_dir\n      - id: import_table\n        type: data_dir\n      - id: resource_table\n        type: data_dir\n      - id: exception_table\n        type: data_dir\n      - id: certificate_table\n        type: data_dir\n      - id: base_relocation_table\n        type: data_dir\n      - id: debug\n        type: data_dir\n      - id: architecture\n        type: data_dir\n      - id: global_ptr\n        type: data_dir\n      - id: tls_table\n        type: data_dir\n      - id: load_config_table\n        type: data_dir\n      - id: bound_import\n        type: data_dir\n      - id: iat\n        type: data_dir\n      - id: delay_import_descriptor\n        type: data_dir\n      - id: clr_runtime_header\n        type: data_dir\n  data_dir:\n    seq:\n      - id: virtual_address\n        type: u4\n      - id: size\n        type: u4\n  section:\n    -webide-representation: \"{name}\"\n    seq:\n      - id: name\n        type: str\n        encoding: UTF-8\n        size: 8\n        pad-right: 0\n      - id: virtual_size\n        type: u4\n      - id: virtual_address\n        type: u4\n      - id: size_of_raw_data\n        type: u4\n      - id: pointer_to_raw_data\n        type: u4\n      - id: pointer_to_relocations\n        type: u4\n      - id: pointer_to_linenumbers\n        type: u4\n      - id: number_of_relocations\n        type: u2\n      - id: number_of_linenumbers\n        type: u2\n      - id: characteristics\n        type: u4\n    instances:\n      body:\n        pos: pointer_to_raw_data\n        size: size_of_raw_data\n  certificate_table:\n    seq:\n      - id: items\n        type: certificate_entry\n        repeat: eos\n  certificate_entry:\n    doc-ref: 'https://learn.microsoft.com/en-us/windows/win32/debug/pe-format#the-attribute-certificate-table-image-only'\n    enums:\n      certificate_revision:\n        0x0100:\n          id: revision_1_0\n          doc: |\n            Version 1, legacy version of the Win_Certificate structure.\n            It is supported only for purposes of verifying legacy Authenticode signatures\n        0x0200:\n          id: revision_2_0\n          doc: Version 2 is the current version of the Win_Certificate structure.\n      certificate_type_enum:\n        0x0001:\n          id: x509\n          doc: |\n            bCertificate contains an X.509 Certificate\n            Not Supported\n        0x0002:\n          id: pkcs_signed_data\n          doc: 'bCertificate contains a PKCS#7 SignedData structure'\n        0x0003:\n          id: reserved_1\n          doc: 'Reserved'\n        0x0004:\n          id: ts_stack_signed\n          doc: |\n            Terminal Server Protocol Stack Certificate signing\n            Not Supported\n    seq:\n      - id: length\n        -orig-id: dwLength\n        type: u4\n        doc: Specifies the length of the attribute certificate entry.\n      - id: revision\n        -orig-id: wRevision\n        type: u2\n        enum: certificate_revision\n        doc: Contains the certificate version number.\n      - id: certificate_type\n        -orig-id: wCertificateType\n        type: u2\n        enum: certificate_type_enum\n        doc: Specifies the type of content in bCertificate\n      - id: certificate_bytes\n        -orig-id: bCertificate\n        size: length - 8\n        doc: Contains a certificate, such as an Authenticode signature.\n"
  },
  {
    "id": "ksy_python_pyc_27",
    "name": "Python Pyc 27",
    "category": "Executable",
    "metadata": {
      "isGenerated": true,
      "fileExtensions": [
        "pyc"
      ],
      "description": "",
      "originalCategory": "executable",
      "filePath": "executable/python_pyc_27.ksy",
      "endian": "le"
    },
    "content": "# https://web.archive.org/web/20170825122655/http://demoseen.com/blog/2010-02-20_Python_Marshal_Format.html\n# https://github.com/python/cpython/blob/main/Lib/dis.py\n# https://github.com/python/cpython/blob/main/Lib/opcode.py\n# https://github.com/python/cpython/blob/2.7/Lib/dis.py\n# https://github.com/python/cpython/blob/2.7/Lib/opcode.py\nmeta:\n  id: python_pyc_27\n  application: Python\n  file-extension: pyc\n  xref:\n    justsolve: Python\n    pronom: fmt/939\n    mime: application/x-python-code\n    wikidata: Q28009469\n  license: CC0-1.0\n  endian: le\ndoc: |\n  Python interpreter runs .py files in 2 step process: first, it\n  produces bytecode, which it then executes. Translation of .py source\n  into bytecode is time-consuming, so Python dumps compiled bytecode\n  into .pyc files, to be reused from cache at later time if possible.\n\n  .pyc file is essentially a raw dump of `py_object` (see `body`) with\n  a simple header prepended.\nseq:\n  - id: version_magic\n    type: u2\n    enum: version\n  - id: crlf\n    type: u2\n  - id: modification_timestamp\n    type: u4\n  - id: body\n    type: py_object\ntypes:\n  assembly:\n    seq:\n      - id: string_magic\n        contents: \"s\"\n      - id: length\n        type: u4\n      - id: items\n        size: length\n        type: op_args\n  op_args:\n    seq:\n      - id: items\n        type: op_arg\n        repeat: eos\n  op_arg:\n    -webide-representation: \"{op_code} {arg}\"\n    seq:\n      - id: op_code\n        type: u1\n        enum: op_code_enum\n      - id: arg\n        type: u2\n        if: \"op_code.to_i >= op_code_enum::store_name.to_i\" # store_name == have_arguments\n    enums:\n      op_code_enum:\n        0  : stop_code\n        1  : pop_top\n        2  : rot_two\n        3  : rot_three\n        4  : dup_top\n        5  : rot_four\n        9  : nop\n        10 : unary_positive\n        11 : unary_negative\n        12 : unary_not\n        13 : unary_convert\n        15 : unary_invert\n        19 : binary_power\n        20 : binary_multiply\n        21 : binary_divide\n        22 : binary_modulo\n        23 : binary_add\n        24 : binary_subtract\n        25 : binary_subscr\n        26 : binary_floor_divide\n        27 : binary_true_divide\n        28 : inplace_floor_divide\n        29 : inplace_true_divide\n        30 : slice_0\n        31 : slice_1\n        32 : slice_2\n        33 : slice_3\n        40 : store_slice_0\n        41 : store_slice_1\n        42 : store_slice_2\n        43 : store_slice_3\n        50 : delete_slice_0\n        51 : delete_slice_1\n        52 : delete_slice_2\n        53 : delete_slice_3\n        54 : store_map\n        55 : inplace_add\n        56 : inplace_subtract\n        57 : inplace_multiply\n        58 : inplace_divide\n        59 : inplace_modulo\n        60 : store_subscr\n        61 : delete_subscr\n        62 : binary_lshift\n        63 : binary_rshift\n        64 : binary_and\n        65 : binary_xor\n        66 : binary_or\n        67 : inplace_power\n        68 : get_iter\n        70 : print_expr\n        71 : print_item\n        72 : print_newline\n        73 : print_item_to\n        74 : print_newline_to\n        75 : inplace_lshift\n        76 : inplace_rshift\n        77 : inplace_and\n        78 : inplace_xor\n        79 : inplace_or\n        80 : break_loop\n        81 : with_cleanup\n        82 : load_locals\n        83 : return_value\n        84 : import_star\n        85 : exec_stmt\n        86 : yield_value\n        87 : pop_block\n        88 : end_finally\n        89 : build_class\n        90 : store_name           # Index in name list\n        91 : delete_name          # \"\"\n        92 : unpack_sequence      # Number of tuple items\n        93 : for_iter\n        94 : list_append\n        95 : store_attr           # Index in name list\n        96 : delete_attr          # \"\"\n        97 : store_global         # \"\"\n        98 : delete_global        # \"\"\n        99 : dup_topx             # number of items to duplicate\n        100: load_const           # Index in const list\n        101: load_name            # Index in name list\n        102: build_tuple          # Number of tuple items\n        103: build_list           # Number of list items\n        104: build_set            # Number of set items\n        105: build_map            # Number of dict entries (upto 255)\n        106: load_attr            # Index in name list\n        107: compare_op           # Comparison operator\n        108: import_name          # Index in name list\n        109: import_from          # Index in name list\n        110: jump_forward         # Number of bytes to skip\n        111: jump_if_false_or_pop # Target byte offset from beginning of code\n        112: jump_if_true_or_pop  # \"\"\n        113: jump_absolute        # \"\"\n        114: pop_jump_if_false    # \"\"\n        115: pop_jump_if_true     # \"\"\n        116: load_global          # Index in name list\n        119: continue_loop        # Target address\n        120: setup_loop           # Distance to target address\n        121: setup_except         # \"\"\n        122: setup_finally        # \"\"\n        124: load_fast            # Local variable number\n        125: store_fast           # Local variable number\n        126: delete_fast          # Local variable number\n        130: raise_varargs        # Number of raise arguments (1, 2, or 3)\n        131: call_function        # #args + (#kwargs << 8)\n        132: make_function        # Number of args with default values\n        133: build_slice          # Number of items\n        134: make_closure\n        135: load_closure\n        136: load_deref\n        137: store_deref\n        140: call_function_var    # #args + (#kwargs << 8)\n        141: call_function_kw     # #args + (#kwargs << 8)\n        142: call_function_var_kw # #args + (#kwargs << 8)\n        143: setup_with\n        145: extended_arg\n        146: set_add\n        147: map_add\n  code_object:\n    -webide-representation: \"{name.value}\"\n    seq:\n      - id: arg_count   # argcount\n        type: u4\n      - id: local_count # nlocals\n        type: u4\n      - id: stack_size\n        type: u4\n      - id: flags\n        type: u4\n        enum: flags_enum\n      - id: code\n        type: assembly\n      - id: consts\n        type: py_object\n      - id: names\n        type: py_object\n      - id: var_names\n        type: py_object\n      - id: free_vars\n        type: py_object\n      - id: cell_vars\n        type: py_object\n      - id: filename\n        type: py_object\n      - id: name\n        type: py_object\n      - id: first_line_no\n        type: u4\n      - id: lnotab\n        type: py_object\n    enums:\n      flags_enum:\n        0x04: has_args\n        0x08: has_kwargs\n        0x20: generator\n  py_object:\n    -webide-representation: \"{type}: {value}\"\n    seq:\n      - id: type\n        type: u1\n        enum: object_type\n      - id: value\n        type:\n          switch-on: type\n          cases:\n            \"object_type::code_object\": code_object\n            \"object_type::string\":      py_string\n            \"object_type::string_ref\":  string_ref\n            \"object_type::interned\":    interned_string\n            \"object_type::tuple\":       tuple\n            \"object_type::int\":         u4\n            \"object_type::py_false\":    py_false\n            \"object_type::py_true\":     py_true\n            \"object_type::none\":        py_none\n    types:\n      py_string:\n        -webide-representation: \"{data}\"\n        seq:\n          - id: length\n            type: u4\n          - id: data\n            size: length\n      interned_string:\n        -webide-representation: \"{data}\"\n        seq:\n          - id: length\n            type: u4\n          - id: data\n            type: str\n            size: length\n            encoding: utf-8\n      string_ref:\n        -webide-representation: \"#{interned_list_index:dec}\"\n        seq:\n          - id: interned_list_index\n            type: u4\n      unicode_string:\n        -webide-representation: \"{data}\"\n        seq:\n          - id: length\n            type: u4\n          - id: data\n            size: length\n            type: str\n            encoding: utf-8\n      tuple:\n        -webide-representation: \"{count:dec} items\"\n        seq:\n          - id: count\n            type: u4\n          - id: items\n            type: py_object\n            repeat: expr\n            repeat-expr: count\n      py_none:\n        -webide-representation: \"None\"\n      py_true:\n        -webide-representation: \"true\"\n      py_false:\n        -webide-representation: \"false\"\n    enums:\n      object_type:\n        40: tuple             # (\n        70: py_false          # F\n        78: none              # N\n        82: string_ref        # R\n        84: py_true           # T\n        99: code_object       # c\n        105: int              # i\n        115: string           # s\n        116: interned         # t\n        117: unicode_string   # u\nenums:\n  # https://github.com/python/cpython/blob/v2.7.18/Python/import.c\n  version:\n    20121: v15\n    50428: v16\n    50823: v20\n    60202: v21\n    60717: v22\n    62011: v23_a0\n    62021: v23_a0b\n    62041: v24_a0\n    62051: v24_a3\n    62061: v24_b1\n    62071: v25_a0\n    62081: v25_a0b\n    62091: v25_a0c\n    62092: v25_a0d\n    62101: v25_b3\n    62111: v25_b3b\n    62121: v25_c1\n    62131: v25_c2\n    62151: v26_a0\n    62161: v26_a1\n    62171: v27_a0\n    62181: v27_a0b\n    62191: v27_a0c\n    62201: v27_a0d\n    62211: v27_a0e\n"
  },
  {
    "id": "ksy_swf",
    "name": "Adobe Flash (AKA Shockwave Flash, Macromedia Flash)",
    "category": "Executable",
    "metadata": {
      "isGenerated": true,
      "fileExtensions": [
        "swf"
      ],
      "description": "Adobe Flash (AKA Shockwave Flash, Macromedia Flash)",
      "originalCategory": "executable",
      "filePath": "executable/swf.ksy",
      "signature": {
        "offset": 0,
        "bytes": [
          87,
          83
        ]
      },
      "endian": "le"
    },
    "content": "meta:\n  id: swf\n  title: Adobe Flash (AKA Shockwave Flash, Macromedia Flash)\n  file-extension: swf\n  xref:\n    justsolve: SWF\n    pronom: fmt/507\n      # - fmt/{505..507} # Adobe Flash {8..10}\n      # - fmt/{757..776} # Adobe Flash {11..30}\n    loc:\n      - fdd000130 # SWF 7\n      - fdd000248 # SWF 8\n    mime: application/x-shockwave-flash\n    wikidata: Q594447\n  tags:\n    - executable\n    - media\n  license: CC0-1.0\n  endian: le\n#  imports:\n#    - abc_bytecode\ndoc: |\n  SWF files are used by Adobe Flash (AKA Shockwave Flash, Macromedia\n  Flash) to encode rich interactive multimedia content and are,\n  essentially, a container for special bytecode instructions to play\n  back that content. In early 2000s, it was dominant rich multimedia\n  web format (.swf files were integrated into web pages and played\n  back with a browser plugin), but its usage largely declined in\n  2010s, as HTML5 and performant browser-native solutions\n  (i.e. JavaScript engines and graphical approaches, such as WebGL)\n  emerged.\n\n  There are a lot of versions of SWF (~36), format is somewhat\n  documented by Adobe.\ndoc-ref: https://open-flash.github.io/mirrors/swf-spec-19.pdf\nseq:\n  - id: compression\n    -orig-id: Signature\n    type: u1\n    enum: compressions\n  - id: signature\n    -orig-id: Signature\n    contents: \"WS\"\n  - id: version\n    -orig-id: Version\n    type: u1\n  - id: len_file\n    -orig-id: FileLength\n    type: u4\n  - id: plain_body\n    size-eos: true\n    type: swf_body\n    if: compression == compressions::none\n  - id: zlib_body\n    size-eos: true\n    process: zlib\n    type: swf_body\n    if: compression == compressions::zlib\ntypes:\n  swf_body:\n    seq:\n      - id: rect\n        type: rect\n      - id: frame_rate\n        type: u2\n      - id: frame_count\n        type: u2\n      - id: file_attributes_tag\n        type: tag\n        if: _root.version >= 8\n      - id: tags\n        type: tag\n        repeat: eos\n  rect:\n    seq:\n      - id: b1\n        type: u1\n      - id: skip\n        size: num_bytes\n    instances:\n      num_bits:\n        value: b1 >> 3\n      num_bytes:\n        value: ((num_bits * 4 - 3) + 7) / 8\n  rgb:\n    seq:\n      - id: r\n        type: u1\n      - id: g\n        type: u1\n      - id: b\n        type: u1\n  tag:\n    seq:\n      - id: record_header\n        type: record_header\n      - id: tag_body\n        size: record_header.len\n        type:\n          switch-on: record_header.tag_type\n          cases:\n            'tag_type::define_sound': define_sound_body\n            'tag_type::do_abc': do_abc_body\n            'tag_type::script_limits': script_limits_body\n            'tag_type::symbol_class': symbol_class_body\n            'tag_type::set_background_color': rgb\n            'tag_type::export_assets': symbol_class_body\n  define_sound_body:\n    seq:\n      - id: id\n        -orig-id: SoundId\n        type: u2\n      - id: format\n        -orig-id: SoundFormat\n        type: b4\n      - id: sampling_rate\n        -orig-id: SoundRate\n        type: b2\n        enum: sampling_rates\n        doc: Sound sampling rate, as per enum. Ignored for Nellymoser and Speex codecs.\n      - id: bits_per_sample\n        -orig-id: SoundSize\n        type: b1\n        enum: bps\n      - id: num_channels\n        -orig-id: SoundType\n        type: b1\n        enum: channels\n      - id: num_samples\n        type: u4\n    enums:\n      sampling_rates:\n        0: rate_5_5_khz\n        1: rate_11_khz\n        2: rate_22_khz\n        3: rate_44_khz\n      bps:\n        0: sound_8_bit\n        1: sound_16_bit\n      channels:\n        0: mono\n        1: stereo\n  do_abc_body:\n    seq:\n      - id: flags\n        type: u4\n      - id: name\n        type: strz\n        encoding: ASCII\n      - id: abcdata\n        size-eos: true\n        #type: abc_bytecode\n  script_limits_body:\n    seq:\n      - id: max_recursion_depth\n        type: u2\n      - id: script_timeout_seconds\n        type: u2\n  symbol_class_body:\n    seq:\n      - id: num_symbols\n        type: u2\n      - id: symbols\n        type: symbol\n        repeat: expr\n        repeat-expr: num_symbols\n    types:\n      symbol:\n        seq:\n          - id: tag\n            type: u2\n          - id: name\n            type: strz\n            encoding: ASCII\n  record_header:\n    seq:\n      - id: tag_code_and_length\n        type: u2\n      - id: big_len\n        type: s4\n        if: small_len == 0x3f\n    instances:\n      tag_type:\n        value: 'tag_code_and_length >> 6'\n        enum: tag_type\n      small_len:\n        value: 'tag_code_and_length & 0b111111'\n      len:\n        value: 'small_len == 0x3f ? big_len : small_len'\nenums:\n  compressions:\n    0x46: none # F\n    0x43: zlib # C\n    0x5a: lzma # Z\n  tag_type:\n    0: end_of_file\n    4: place_object\n    5: remove_object\n    9: set_background_color\n    14: define_sound\n    26: place_object2\n    28: remove_object2\n    43: frame_label\n    56: export_assets\n    65: script_limits\n    69: file_attributes\n    70: place_object3\n    76: symbol_class\n    77: metadata\n    78: define_scaling_grid\n    82: do_abc\n    86: define_scene_and_frame_label_data\n"
  },
  {
    "id": "ksy_uefi_te",
    "name": "TE (Terse Executable) file",
    "category": "Executable",
    "metadata": {
      "isGenerated": true,
      "fileExtensions": [
        "efi",
        "te"
      ],
      "description": "TE (Terse Executable) file",
      "originalCategory": "executable",
      "filePath": "executable/uefi_te.ksy",
      "endian": "le"
    },
    "content": "meta:\n  id: uefi_te\n  title: TE (Terse Executable) file\n  application: UEFI\n  file-extension:\n    - efi\n    - te\n  xref:\n    wikidata: Q83443959\n  tags:\n    - executable\n    - firmware\n  license: CC0-1.0\n  ks-version: 0.7\n  endian: le\ndoc: |\n  This type of executables could be found inside the UEFI firmware. The UEFI\n  firmware is stored in SPI flash memory, which is a chip soldered on a\n  system's motherboard. UEFI firmware is very modular: it usually contains\n  dozens, if not hundreds, of executables. To store all these separates files,\n  the firmware is laid out in volumes using the Firmware File System (FFS), a\n  file system specifically designed to store firmware images. The volumes\n  contain files that are identified by GUIDs and each of these files contain\n  one or more sections holding the data. One of these sections contains the\n  actual executable image. Most of the executable images follow the PE format.\n  However, some of them follow the TE format.\n\n  The Terse Executable (TE) image format was created as a mechanism to reduce\n  the overhead of the PE/COFF headers in PE32/PE32+ images, resulting in a\n  corresponding reduction of image sizes for executables running in the PI\n  (Platform Initialization) Architecture environment. Reducing image size\n  provides an opportunity for use of a smaller system flash part.\n\n  So the TE format is basically a stripped version of PE.\n\ndoc-ref: https://uefi.org/sites/default/files/resources/PI_Spec_1_6.pdf\nseq:\n  - id: te_hdr\n    size: 0x28\n    type: te_header\n  - id: sections\n    type: section\n    repeat: expr\n    repeat-expr: te_hdr.num_sections\ntypes:\n  te_header:\n    seq:\n      - id: magic\n        contents: \"VZ\"\n      - id: machine\n        type: u2\n        enum: machine_type\n      - id: num_sections\n        type: u1\n      - id: subsystem\n        type: u1\n        enum: subsystem_enum\n      - id: stripped_size\n        type: u2\n      - id: entry_point_addr\n        type: u4\n      - id: base_of_code\n        type: u4\n      - id: image_base\n        type: u8\n      - id: data_dirs\n        type: header_data_dirs\n    enums:\n      # Don't forget to update the `machine_type` enum in `executable/microsoft_pe.ksy` when\n      # you modify this one.\n      #\n      # https://learn.microsoft.com/en-us/windows/win32/debug/pe-format#machine-types\n      machine_type:\n        0x0:\n          id: unknown\n          doc: The content of this field is assumed to be applicable to any machine type\n        0x184:\n          id: alpha\n          doc: Alpha AXP, 32-bit address space\n        0x284:\n          id: alpha64_or_axp64\n          -orig-id:\n            - IMAGE_FILE_MACHINE_ALPHA64\n            - IMAGE_FILE_MACHINE_AXP64\n          doc: |\n            > Alpha 64, 64-bit address space\n            or\n            > AXP 64 (Same as Alpha 64)\n        0x1d3:\n          id: am33\n          doc: Matsushita AM33\n        0x8664:\n          id: amd64\n          doc: x64\n        0x1c0:\n          id: arm\n          doc: ARM little endian\n        0xaa64:\n          id: arm64\n          doc: ARM64 little endian\n        0x1c4:\n          id: arm_nt\n          -orig-id: IMAGE_FILE_MACHINE_ARMNT\n          doc: ARM Thumb-2 little endian\n        0xebc:\n          id: ebc\n          doc: EFI byte code\n        0x14c:\n          id: i386\n          doc: Intel 386 or later processors and compatible processors\n        0x200:\n          id: ia64\n          doc: Intel Itanium processor family\n        0x6232:\n          id: loongarch32\n          doc: LoongArch 32-bit processor family\n        0x6264:\n          id: loongarch64\n          doc: LoongArch 64-bit processor family\n        0x9041:\n          id: m32r\n          doc: Mitsubishi M32R little endian\n        0x266:\n          id: mips16\n          doc: MIPS16\n        0x366:\n          id: mips_fpu\n          -orig-id: IMAGE_FILE_MACHINE_MIPSFPU\n          doc: MIPS with FPU\n        0x466:\n          id: mips16_fpu\n          -orig-id: IMAGE_FILE_MACHINE_MIPSFPU16\n          doc: MIPS16 with FPU\n        0x1f0:\n          id: powerpc\n          doc: Power PC little endian\n        0x1f1:\n          id: powerpc_fp\n          -orig-id: IMAGE_FILE_MACHINE_POWERPCFP\n          doc: Power PC with floating point support\n        0x166:\n          id: r4000\n          doc: MIPS little endian\n        0x5032:\n          id: riscv32\n          doc: RISC-V 32-bit address space\n        0x5064:\n          id: riscv64\n          doc: RISC-V 64-bit address space\n        0x5128:\n          id: riscv128\n          doc: RISC-V 128-bit address space\n        0x1a2:\n          id: sh3\n          doc: Hitachi SH3\n        0x1a3:\n          id: sh3_dsp\n          -orig-id: IMAGE_FILE_MACHINE_SH3DSP\n          doc: Hitachi SH3 DSP\n        0x1a6:\n          id: sh4\n          doc: Hitachi SH4\n        0x1a8:\n          id: sh5\n          doc: Hitachi SH5\n        0x1c2:\n          id: thumb\n          doc: Thumb\n        0x169:\n          id: wce_mips_v2\n          -orig-id: IMAGE_FILE_MACHINE_WCEMIPSV2\n          doc: MIPS little-endian WCE v2\n      subsystem_enum:\n        0: unknown\n        1: native\n        2: windows_gui\n        3: windows_cui\n        7: posix_cui\n        9: windows_ce_gui\n        10: efi_application\n        11: efi_boot_service_driver\n        12: efi_runtime_driver\n        13: efi_rom\n        14: xbox\n        16: windows_boot_application\n  header_data_dirs:\n    seq:\n      - id: base_relocation_table\n        type: data_dir\n      - id: debug\n        type: data_dir\n  data_dir:\n    seq:\n      - id: virtual_address\n        type: u4\n      - id: size\n        type: u4\n  section:\n    seq:\n      - id: name\n        type: str\n        encoding: UTF-8\n        size: 8\n        pad-right: 0\n      - id: virtual_size\n        type: u4\n      - id: virtual_address\n        type: u4\n      - id: size_of_raw_data\n        type: u4\n      - id: pointer_to_raw_data\n        type: u4\n      - id: pointer_to_relocations\n        type: u4\n      - id: pointer_to_linenumbers\n        type: u4\n      - id: num_relocations\n        type: u2\n      - id: num_linenumbers\n        type: u2\n      - id: characteristics\n        type: u4\n    instances:\n      body:\n        pos: pointer_to_raw_data - _root.te_hdr.stripped_size + _root.te_hdr._io.size\n        size: size_of_raw_data\n"
  }
];

export default {
  category: "Executable",
  formats: executableFormats
};
